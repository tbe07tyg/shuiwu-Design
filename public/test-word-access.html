<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word文档访问测试</title>
</head>
<body>
    <h1>Word文档访问测试</h1>
    
    <div>
        <h2>测试1: 直接链接访问</h2>
        <a href="/附件二：研发项目申请书(1).doc" target="_blank">点击下载Word文档</a>
    </div>
    
    <div>
        <h2>测试2: JavaScript Fetch测试</h2>
        <button onclick="testFetch()">测试Fetch访问</button>
        <div id="fetchResult"></div>
    </div>
    
    <div>
        <h2>测试3: Mammoth.js测试</h2>
        <button onclick="testMammoth()">测试Mammoth.js处理</button>
        <div id="mammothResult"></div>
    </div>

    <script src="https://unpkg.com/mammoth@1.10.0/mammoth.browser.min.js"></script>
    <script>
        async function testFetch() {
            const resultDiv = document.getElementById('fetchResult');
            try {
                resultDiv.innerHTML = '正在测试...';
                const response = await fetch('/附件二：研发项目申请书(1).doc');
                resultDiv.innerHTML = `
                    <p>状态: ${response.status} ${response.statusText}</p>
                    <p>内容类型: ${response.headers.get('content-type')}</p>
                    <p>内容长度: ${response.headers.get('content-length')} bytes</p>
                `;
            } catch (error) {
                resultDiv.innerHTML = `<p style="color: red;">错误: ${error.message}</p>`;
            }
        }
        
        async function testMammoth() {
            const resultDiv = document.getElementById('mammothResult');
            try {
                resultDiv.innerHTML = '正在处理...';
                
                const response = await fetch('/附件二：研发项目申请书(1).doc');
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const arrayBuffer = await response.arrayBuffer();
                console.log('文档大小:', arrayBuffer.byteLength, 'bytes');
                
                const result = await mammoth.extractRawText({arrayBuffer});
                
                resultDiv.innerHTML = `
                    <p>✅ 处理成功!</p>
                    <p>文档大小: ${arrayBuffer.byteLength} bytes</p>
                    <p>提取文本长度: ${result.value.length} 字符</p>
                    <details>
                        <summary>提取的文本内容（前500字符）</summary>
                        <pre style="white-space: pre-wrap; max-height: 200px; overflow-y: auto; border: 1px solid #ccc; padding: 10px;">${result.value.substring(0, 500)}...</pre>
                    </details>
                `;
            } catch (error) {
                resultDiv.innerHTML = `<p style="color: red;">❌ 错误: ${error.message}</p>`;
                console.error('Mammoth处理失败:', error);
            }
        }
    </script>
</body>
</html>
