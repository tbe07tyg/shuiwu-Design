# 页面设计 v4.0 - 材料提交模板维护功能

## 概述

本版本新增了**材料提交模板维护功能**，这是一个系统级的基础配置模块，用于统一管理立项申请、项目开题、项目中期、项目验收等各环节所需提交的资料类目和模板文件。

## 功能特色

### 🎯 核心功能
- **统一管理**：四大业务环节的资料类目集中维护
- **灵活配置**：支持自定义类目名称、必填设置、模板文件
- **实时同步**：配置完成后自动同步到对应业务页面
- **批量操作**：支持Excel批量导入导出配置
- **效果预览**：实时预览配置在业务页面的效果

### 🛠 技术特点
- **Vue 3 + Element Plus**：现代化的前端技术栈
- **响应式设计**：支持桌面端、平板、移动端
- **拖拽排序**：直观的类目顺序调整
- **文件管理**：完善的模板文件上传下载机制
- **数据验证**：严格的表单验证和文件格式检查

## 文件结构

```
页面设计v4.0/
├── README.md                           # 本文档
├── 21-材料提交模板维护页面设计文档.md    # 详细设计文档
├── 材料提交模板维护界面原型设计.html     # HTML原型展示
└── MaterialTemplateManager.vue         # Vue组件实现
```

## 设计亮点

### 1. 界面布局设计
- **标签页导航**：清晰区分四大业务环节
- **工具栏设计**：功能按钮合理分组
- **表格展示**：信息密度适中，操作便捷
- **预览面板**：实时展示配置效果

### 2. 交互体验优化
- **一键添加**：简洁的类目添加流程
- **在线编辑**：弹窗式编辑，保持页面连贯性
- **批量操作**：Excel导入导出，提高工作效率
- **即时反馈**：操作结果实时提示

### 3. 数据同步机制
- **配置保存**：本地保存配置变更
- **同步应用**：一键同步到业务页面
- **版本管理**：保留配置变更历史
- **回滚机制**：支持配置回退

## 界面展示

### 主界面布局
```
┌─────────────────────────────────────────────────────────────┐
│  📋 材料提交模板维护                                        │
├─────────────────────────────────────────────────────────────┤
│  [立项申请] [项目开题] [项目中期] [项目验收]                 │
├─────────────────────────────────────────────────────────────┤
│  + 添加新类目                              [批量导入/导出]  │
│                                                             │
│  序号  类目名称      必填项  模板文件    操作               │
│  ─────────────────────────────────────────────────────────  │
│   1   项目申请书      ✓     📄 模板1.doc  编辑 预览 删除   │
│   2   可行性研究报告  ✓     📄 模板2.doc  编辑 预览 删除   │
│   3   预算明细表      ✓     📊 模板3.xls  编辑 预览 删除   │
│                                                             │
│  📱 效果预览：立项申请页面资料提交区域                      │
│  ─────────────────────────────────────────────────────────  │
│  * 项目申请书           [上传] [模板]                      │
│  * 可行性研究报告       [上传] [模板]                      │
│  * 预算明细表           [上传] [模板]                      │
│                                                             │
│  状态信息                    [预览] [保存] [同步应用]       │
└─────────────────────────────────────────────────────────────┘
```

### 添加类目对话框
```
┌─ 添加资料类目 ────────────────────────┐
│  类目名称：[________________]          │
│  是否必填：( ✓ ) 必填  ( ○ ) 选填     │
│  模板文件：[选择文件] [预览] [下载]   │
│  显示顺序：[___3___]                   │
│  描述说明：[________________________] │
│           [确定] [取消]                │
└────────────────────────────────────────┘
```

## 业务流程

### 配置维护流程
1. **选择业务环节** → 切换到对应标签页
2. **查看当前配置** → 显示已有类目列表
3. **执行配置操作** → 添加/编辑/删除/排序
4. **预览配置效果** → 查看在业务页面的展示效果
5. **保存并同步** → 将配置应用到实际业务页面

### 模板管理流程
1. **上传模板文件** → 选择本地文件上传
2. **文件格式验证** → 检查文件类型和大小
3. **保存文件信息** → 记录文件路径和名称
4. **提供预览下载** → 支持在线预览和下载

## 技术实现

### 前端技术栈
- **框架**：Vue 3 Composition API
- **UI组件**：Element Plus
- **状态管理**：响应式数据管理
- **文件处理**：el-upload 组件
- **表格操作**：el-table + 自定义操作列

### 数据结构
```javascript
// 类目配置数据模型
interface MaterialCategory {
  id: number;                    // 类目ID
  businessType: string;          // 业务类型：apply/opening/midterm/acceptance
  categoryName: string;          // 类目名称
  isRequired: boolean;           // 是否必填
  templateFileName?: string;     // 模板文件名
  templateFilePath?: string;     // 模板文件路径
  sortOrder: number;             // 排序序号
  description?: string;          // 描述说明
  status: number;                // 状态：0-禁用，1-启用
}
```

### 核心功能实现

#### 动态表单生成
```javascript
// 根据配置动态生成业务页面的表单项
const generateFormItems = (configs) => {
  return configs.map(config => ({
    prop: `file_${config.id}`,
    label: config.categoryName,
    required: config.isRequired,
    type: 'upload',
    templateUrl: config.templateFilePath,
    templateName: config.templateFileName
  }));
};
```

#### 配置同步机制
```javascript
// 配置保存后同步到业务页面
const syncConfigToPages = async (businessType, configs) => {
  const targetPages = getTargetPages(businessType);
  
  for (const page of targetPages) {
    await updatePageConfig(page, configs);
  }
  
  // 刷新相关页面缓存
  await refreshPageCache(targetPages);
};
```

## 使用指南

### 1. 基本操作
- **添加类目**：点击"添加新类目"按钮，填写类目信息
- **编辑类目**：点击表格中的"编辑"按钮进行修改
- **删除类目**：点击"删除"按钮，确认后删除
- **调整顺序**：通过拖拽或编辑排序号调整显示顺序

### 2. 模板管理
- **上传模板**：在编辑界面选择并上传模板文件
- **预览模板**：点击"预览"按钮在线查看模板内容
- **下载模板**：点击"下载"按钮获取模板文件
- **更换模板**：重新上传文件即可替换原模板

### 3. 批量操作
- **批量导入**：下载Excel模板，填写后上传导入
- **批量导出**：将当前配置导出为Excel文件
- **重置默认**：恢复系统默认的类目配置

### 4. 配置同步
- **保存配置**：将当前修改保存到数据库
- **预览效果**：查看配置在业务页面的展示效果
- **同步应用**：将配置实时应用到相关业务页面

## 扩展说明

### 支持的文件格式
- **Word文档**：.doc, .docx
- **Excel表格**：.xls, .xlsx
- **PDF文档**：.pdf
- **文本文件**：.txt

### 配置应用范围
- **立项申请**：立项申请页面的资料提交区域
- **项目开题**：开题申请页面的资料提交区域
- **项目中期**：中期检查页面的资料提交区域
- **项目验收**：验收申请页面的资料提交区域

## 后续优化

### 功能增强
1. **模板版本管理**：支持模板文件的版本控制
2. **权限控制**：不同角色的配置权限管理
3. **审批流程**：配置变更的审批机制
4. **使用统计**：类目使用情况的统计分析

### 性能优化
1. **大文件处理**：优化大模板文件的上传下载
2. **缓存机制**：配置数据的本地缓存
3. **懒加载**：按需加载业务环节的配置数据
4. **并发控制**：多用户同时配置的冲突处理

## 总结

材料提交模板维护功能作为系统的基础配置模块，实现了资料类目的统一管理和灵活配置。通过直观的界面设计、便捷的操作流程和实时的效果预览，大大提高了系统管理的效率和用户体验。

该功能的设计充分考虑了实际使用场景，支持批量操作、模板管理、配置同步等高级功能，为科研管理系统提供了强有力的基础支撑。

---

*本文档为材料提交模板维护功能的完整设计方案，包含了需求分析、界面设计、技术实现、使用指南等各个方面的详细说明。* 