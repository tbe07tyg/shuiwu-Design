import{e,I as ue,_ as W,g as r,b as R,i as b,d as s,t as g,w as t,A as Q,m as k,j as l,D as te,S as de,G as Ce,p as F,q as $e,a as M,r as Oe,l as De,f as j,k as A,F as Ee,P as Se,v as T,x as G,H as Pe,J as fe,c as Re,o as ze,h as Ie,K as Me,n as Ue,L as Ae,M as je,N as Be,O as Le}from"./index-XOIS1SV9.js";import{U as Fe}from"./UserOutlined-BBO7oUck.js";import{B as me}from"./BulbOutlined-DZEqlzpn.js";import{U as he}from"./UploadOutlined-BeZhUyI8.js";import{P as Te}from"./PageContainer-BUwLJmxd.js";/* empty css                                                                      */var Ne={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M536.1 273H488c-4.4 0-8 3.6-8 8v275.3c0 2.6 1.2 5 3.3 6.5l165.3 120.7c3.6 2.6 8.6 1.9 11.2-1.7l28.6-39c2.7-3.7 1.9-8.7-1.7-11.2L544.1 528.5V281c0-4.4-3.6-8-8-8zm219.8 75.2l156.8 38.3c5 1.2 9.9-2.6 9.9-7.7l.8-161.5c0-6.7-7.7-10.5-12.9-6.3L752.9 334.1a8 8 0 003 14.1zm167.7 301.1l-56.7-19.5a8 8 0 00-10.1 4.8c-1.9 5.1-3.9 10.1-6 15.1-17.8 42.1-43.3 80-75.9 112.5a353 353 0 01-112.5 75.9 352.18 352.18 0 01-137.7 27.8c-47.8 0-94.1-9.3-137.7-27.8a353 353 0 01-112.5-75.9c-32.5-32.5-58-70.4-75.9-112.5A353.44 353.44 0 01171 512c0-47.8 9.3-94.2 27.8-137.8 17.8-42.1 43.3-80 75.9-112.5a353 353 0 01112.5-75.9C430.6 167.3 477 158 524.8 158s94.1 9.3 137.7 27.8A353 353 0 01775 261.7c10.2 10.3 19.8 21 28.6 32.3l59.8-46.8C784.7 146.6 662.2 81.9 524.6 82 285 82.1 92.6 276.7 95 516.4 97.4 751.9 288.9 942 524.8 942c185.5 0 343.5-117.6 403.7-282.3 1.5-4.2-.7-8.9-4.9-10.4z"}}]},name:"history",theme:"outlined"};function se(o){for(var u=1;u<arguments.length;u++){var c=arguments[u]!=null?Object(arguments[u]):{},_=Object.keys(c);typeof Object.getOwnPropertySymbols=="function"&&(_=_.concat(Object.getOwnPropertySymbols(c).filter(function(q){return Object.getOwnPropertyDescriptor(c,q).enumerable}))),_.forEach(function(q){Ve(o,q,c[q])})}return o}function Ve(o,u,c){return u in o?Object.defineProperty(o,u,{value:c,enumerable:!0,configurable:!0,writable:!0}):o[u]=c,o}var ne=function(u,c){var _=se({},u,c.attrs);return e(ue,se({},_,{icon:Ne}),null)};ne.displayName="HistoryOutlined";ne.inheritAttrs=!1;var He={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"};function re(o){for(var u=1;u<arguments.length;u++){var c=arguments[u]!=null?Object(arguments[u]):{},_=Object.keys(c);typeof Object.getOwnPropertySymbols=="function"&&(_=_.concat(Object.getOwnPropertySymbols(c).filter(function(q){return Object.getOwnPropertyDescriptor(c,q).enumerable}))),_.forEach(function(q){Qe(o,q,c[q])})}return o}function Qe(o,u,c){return u in o?Object.defineProperty(o,u,{value:c,enumerable:!0,configurable:!0,writable:!0}):o[u]=c,o}var le=function(u,c){var _=re({},u,c.attrs);return e(ue,re({},_,{icon:He}),null)};le.displayName="MoreOutlined";le.inheritAttrs=!1;const Ge={class:"card-header"},We={class:"card-title"},Je={class:"card-content"},Xe={class:"card-desc"},Ye={class:"card-meta"},Ze={class:"card-info"},Ke={class:"info-item"},et={class:"info-item"},tt={key:0,class:"card-effect"},nt={class:"effect-title"},lt={class:"effect-content"},ot={class:"card-footer"},at={class:"footer-main"},it={class:"status-actions"},st={__name:"RequirementCard",props:{requirement:{type:Object,required:!0}},emits:["edit","delete","view","start-research","status-change","priority-change"],setup(o,{emit:u}){const c=o,_=u;function q(d){return{高:"red",中:"orange",低:"blue"}[d]||"default"}function z(d){_("status-change",c.requirement.id,d)}function m(d){_("priority-change",c.requirement.id,d)}return(d,i)=>{const O=r("a-menu-item"),U=r("a-menu-divider"),E=r("a-menu"),B=r("a-button"),p=r("a-dropdown"),a=r("a-tag"),v=r("a-select-option"),C=r("a-select");return b(),R("div",{class:"requirement-card",onClick:i[7]||(i[7]=S=>d.$emit("view",o.requirement))},[s("div",Ge,[s("div",We,g(o.requirement.title),1),e(p,{trigger:"click",onClick:i[4]||(i[4]=Q(()=>{},["stop"]))},{overlay:t(()=>[e(E,null,{default:t(()=>[e(O,{onClick:i[0]||(i[0]=S=>d.$emit("edit",o.requirement))},{default:t(()=>[e(k(te)),i[8]||(i[8]=l(" 编辑 "))]),_:1,__:[8]}),e(O,{onClick:i[1]||(i[1]=S=>d.$emit("start-research",o.requirement))},{default:t(()=>[e(k(de)),i[9]||(i[9]=l(" 开始调研 "))]),_:1,__:[9]}),e(U),e(O,{onClick:i[2]||(i[2]=S=>d.$emit("delete",o.requirement)),style:{color:"#ff4d4f"}},{default:t(()=>[e(k(Ce)),i[10]||(i[10]=l(" 删除 "))]),_:1,__:[10]})]),_:1})]),default:t(()=>[e(B,{type:"text",size:"small",onClick:i[3]||(i[3]=Q(()=>{},["stop"]))},{default:t(()=>[e(k(le))]),_:1})]),_:1})]),s("div",Je,[s("p",Xe,g(o.requirement.description),1),s("div",Ye,[e(a,{color:q(o.requirement.priority),size:"small"},{default:t(()=>[l(g(o.requirement.priority)+"优先级 ",1)]),_:1},8,["color"]),e(a,{size:"small"},{default:t(()=>[l(g(o.requirement.category),1)]),_:1})]),s("div",Ze,[s("div",Ke,[e(k(Fe)),s("span",null,g(o.requirement.proposer),1)]),s("div",et,[e(k($e)),s("span",null,g(o.requirement.createdAt),1)])]),o.requirement.expectedEffect?(b(),R("div",tt,[s("div",nt,[e(k(me)),i[11]||(i[11]=s("span",null,"预期效果：",-1))]),s("div",lt,g(o.requirement.expectedEffect),1)])):F("",!0)]),s("div",ot,[s("div",at,[s("div",it,[e(C,{value:o.requirement.status,size:"small",style:{width:"100px"},onChange:z,onClick:i[5]||(i[5]=Q(()=>{},["stop"]))},{default:t(()=>[e(v,{value:"待分析"},{default:t(()=>i[12]||(i[12]=[l("待分析")])),_:1,__:[12]}),e(v,{value:"进行中"},{default:t(()=>i[13]||(i[13]=[l("进行中")])),_:1,__:[13]}),e(v,{value:"已完成"},{default:t(()=>i[14]||(i[14]=[l("已完成")])),_:1,__:[14]}),e(v,{value:"已暂停"},{default:t(()=>i[15]||(i[15]=[l("已暂停")])),_:1,__:[15]})]),_:1},8,["value"]),e(C,{value:o.requirement.priority,size:"small",style:{width:"80px"},onChange:m,onClick:i[6]||(i[6]=Q(()=>{},["stop"]))},{default:t(()=>[e(v,{value:"高"},{default:t(()=>i[16]||(i[16]=[l("高")])),_:1,__:[16]}),e(v,{value:"中"},{default:t(()=>i[17]||(i[17]=[l("中")])),_:1,__:[17]}),e(v,{value:"低"},{default:t(()=>i[18]||(i[18]=[l("低")])),_:1,__:[18]})]),_:1},8,["value"])])])])])}}},rt=W(st,[["__scopeId","data-v-e3fd684f"]]),ut={__name:"RequirementModal",props:{visible:{type:Boolean,default:!1},requirement:{type:Object,default:null}},emits:["update:visible","save"],setup(o,{emit:u}){const c=o,_=u,q=M(),z=M(!1),m=Oe({title:"",description:"",category:"",priority:"",proposer:"当前用户",proposerDept:"",expectedEffect:"",attachments:[]}),d={title:[{required:!0,message:"请输入需求标题",trigger:"blur"},{min:5,max:100,message:"标题长度在5-100个字符",trigger:"blur"}],description:[{required:!0,message:"请输入需求描述",trigger:"blur"},{min:20,max:500,message:"描述长度在20-500个字符",trigger:"blur"}],category:[{required:!0,message:"请选择需求分类",trigger:"change"}],priority:[{required:!0,message:"请选择优先级",trigger:"change"}],proposerDept:[{required:!0,message:"请选择提出部门",trigger:"change"}]};De(()=>c.requirement,p=>{p?Object.assign(m,{title:p.title||"",description:p.description||"",category:p.category||"",priority:p.priority||"",proposer:p.proposer||"当前用户",proposerDept:p.proposerDept||"",expectedEffect:p.expectedEffect||p.businessValue||"",attachments:p.attachments||[]}):i()},{immediate:!0});function i(){var p;Object.assign(m,{title:"",description:"",category:"",priority:"",proposer:"当前用户",proposerDept:"",expectedEffect:"",attachments:[]}),(p=q.value)==null||p.resetFields()}async function O(){try{await q.value.validate(),z.value=!0;const p={...m};await new Promise(a=>setTimeout(a,1e3)),_("save",p),_("update:visible",!1)}catch(p){console.error("表单验证失败:",p)}finally{z.value=!1}}function U(){_("update:visible",!1)}function E(p){return["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","image/jpeg","image/png","image/gif"].includes(p.type)?(p.size/1024/1024<10||A.error("文件大小不能超过10MB!"),!1):(A.error("只能上传PDF、Word、Excel、图片格式的文件!"),!1)}function B(p){const a=m.attachments.indexOf(p),v=m.attachments.slice();v.splice(a,1),m.attachments=v}return(p,a)=>{const v=r("a-input"),C=r("a-form-item"),S=r("a-col"),L=r("a-row"),D=r("a-select-option"),P=r("a-select"),N=r("a-textarea"),h=r("a-button"),V=r("a-upload"),J=r("a-form"),X=r("a-modal");return b(),j(X,{open:o.visible,title:o.requirement?"编辑需求":"新增需求",width:"600px",onOk:O,onCancel:U,"confirm-loading":z.value},{default:t(()=>[e(J,{ref_key:"formRef",ref:q,model:m,rules:d,layout:"vertical","label-col":{span:24},"wrapper-col":{span:24}},{default:t(()=>[e(L,{gutter:16},{default:t(()=>[e(S,{span:24},{default:t(()=>[e(C,{label:"需求标题",name:"title",required:""},{default:t(()=>[e(v,{value:m.title,"onUpdate:value":a[0]||(a[0]=$=>m.title=$),placeholder:"请输入需求标题","max-length":100,"show-count":""},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(L,{gutter:16},{default:t(()=>[e(S,{span:8},{default:t(()=>[e(C,{label:"需求分类",name:"category",required:""},{default:t(()=>[e(P,{value:m.category,"onUpdate:value":a[1]||(a[1]=$=>m.category=$),placeholder:"请选择分类"},{default:t(()=>[e(D,{value:"技术创新"},{default:t(()=>a[7]||(a[7]=[l("技术创新")])),_:1,__:[7]}),e(D,{value:"工艺改进"},{default:t(()=>a[8]||(a[8]=[l("工艺改进")])),_:1,__:[8]}),e(D,{value:"设备更新"},{default:t(()=>a[9]||(a[9]=[l("设备更新")])),_:1,__:[9]}),e(D,{value:"质量提升"},{default:t(()=>a[10]||(a[10]=[l("质量提升")])),_:1,__:[10]}),e(D,{value:"成本控制"},{default:t(()=>a[11]||(a[11]=[l("成本控制")])),_:1,__:[11]})]),_:1},8,["value"])]),_:1})]),_:1}),e(S,{span:8},{default:t(()=>[e(C,{label:"优先级",name:"priority",required:""},{default:t(()=>[e(P,{value:m.priority,"onUpdate:value":a[2]||(a[2]=$=>m.priority=$),placeholder:"请选择优先级"},{default:t(()=>[e(D,{value:"高"},{default:t(()=>a[12]||(a[12]=[l("高优先级")])),_:1,__:[12]}),e(D,{value:"中"},{default:t(()=>a[13]||(a[13]=[l("中优先级")])),_:1,__:[13]}),e(D,{value:"低"},{default:t(()=>a[14]||(a[14]=[l("低优先级")])),_:1,__:[14]})]),_:1},8,["value"])]),_:1})]),_:1}),e(S,{span:8},{default:t(()=>[e(C,{label:"提出部门",name:"proposerDept",required:""},{default:t(()=>[e(P,{value:m.proposerDept,"onUpdate:value":a[3]||(a[3]=$=>m.proposerDept=$),placeholder:"请选择部门"},{default:t(()=>[e(D,{value:"技术部"},{default:t(()=>a[15]||(a[15]=[l("技术部")])),_:1,__:[15]}),e(D,{value:"工艺部"},{default:t(()=>a[16]||(a[16]=[l("工艺部")])),_:1,__:[16]}),e(D,{value:"运维部"},{default:t(()=>a[17]||(a[17]=[l("运维部")])),_:1,__:[17]}),e(D,{value:"质量部"},{default:t(()=>a[18]||(a[18]=[l("质量部")])),_:1,__:[18]}),e(D,{value:"财务部"},{default:t(()=>a[19]||(a[19]=[l("财务部")])),_:1,__:[19]})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),e(L,{gutter:16},{default:t(()=>[e(S,{span:24},{default:t(()=>[e(C,{label:"需求描述",name:"description",required:""},{default:t(()=>[e(N,{value:m.description,"onUpdate:value":a[4]||(a[4]=$=>m.description=$),placeholder:"请详细描述需求内容、背景和预期目标",rows:4,"max-length":500,"show-count":""},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(L,{gutter:16},{default:t(()=>[e(S,{span:24},{default:t(()=>[e(C,{label:"预期达到效果",name:"expectedEffect"},{default:t(()=>[e(N,{value:m.expectedEffect,"onUpdate:value":a[5]||(a[5]=$=>m.expectedEffect=$),placeholder:"请描述预期达到的效果和收益",rows:3,"max-length":300,"show-count":""},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(L,{gutter:16},{default:t(()=>[e(S,{span:24},{default:t(()=>[e(C,{label:"相关附件"},{default:t(()=>[e(V,{"file-list":m.attachments,"onUpdate:fileList":a[6]||(a[6]=$=>m.attachments=$),"before-upload":E,remove:B,multiple:""},{default:t(()=>[e(h,null,{default:t(()=>[e(k(he)),a[20]||(a[20]=l(" 选择文件 "))]),_:1,__:[20]}),a[21]||(a[21]=s("span",{style:{"margin-left":"8px",color:"#999","font-size":"12px"}}," 支持PDF、Word、Excel、图片格式，单文件最大10MB ",-1))]),_:1,__:[21]},8,["file-list"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title","confirm-loading"])}}},dt=W(ut,[["__scopeId","data-v-bfed0498"]]),ft={class:"requirement-detail"},mt={class:"detail-section"},ct={class:"section-title"},pt={class:"detail-section"},_t={class:"section-title"},vt={class:"description-content"},gt={key:0,class:"detail-section"},yt={class:"section-title"},bt={class:"expected-effect"},qt={key:1,class:"detail-section"},kt={class:"section-title"},xt={class:"attachments-list"},wt={class:"file-name"},Ct={key:2,class:"detail-section"},$t={class:"section-title"},Ot={class:"timeline-content"},Dt={class:"timeline-header"},Et={class:"timeline-user"},St={class:"timeline-time"},Pt={class:"timeline-action"},Rt={key:0,class:"timeline-comment"},zt={class:"detail-actions"},It={__name:"RequirementDetail",props:{requirement:{type:Object,required:!0}},emits:["edit","start-research"],setup(o,{emit:u}){function c(m){return{高:"red",中:"orange",低:"blue"}[m]||"default"}function _(m){return{待分析:"default",进行中:"processing",已完成:"success",已暂停:"warning"}[m]||"default"}function q(m){return{create:"blue",edit:"orange",status:"green",comment:"gray"}[m]||"blue"}function z(){A.success("需求详情导出功能开发中...")}return(m,d)=>{const i=r("a-descriptions-item"),O=r("a-tag"),U=r("a-descriptions"),E=r("a-button"),B=r("a-timeline-item"),p=r("a-timeline"),a=r("a-space");return b(),R("div",ft,[s("div",mt,[s("h3",ct,[e(k(Ee)),d[2]||(d[2]=l(" 基本信息 "))]),e(U,{column:2,bordered:"",size:"small"},{default:t(()=>[e(i,{label:"需求标题",span:2},{default:t(()=>[l(g(o.requirement.title),1)]),_:1}),e(i,{label:"需求分类"},{default:t(()=>[e(O,null,{default:t(()=>[l(g(o.requirement.category),1)]),_:1})]),_:1}),e(i,{label:"优先级"},{default:t(()=>[e(O,{color:c(o.requirement.priority)},{default:t(()=>[l(g(o.requirement.priority)+"优先级 ",1)]),_:1},8,["color"])]),_:1}),e(i,{label:"当前状态"},{default:t(()=>[e(O,{color:_(o.requirement.status)},{default:t(()=>[l(g(o.requirement.status),1)]),_:1},8,["color"])]),_:1}),e(i,{label:"提出人"},{default:t(()=>[l(g(o.requirement.proposer),1)]),_:1}),e(i,{label:"提出部门"},{default:t(()=>[l(g(o.requirement.proposerDept),1)]),_:1}),e(i,{label:"提出时间",span:2},{default:t(()=>[l(g(o.requirement.createdAt),1)]),_:1})]),_:1})]),s("div",pt,[s("h3",_t,[e(k(te)),d[3]||(d[3]=l(" 需求描述 "))]),s("div",vt,g(o.requirement.description),1)]),o.requirement.expectedEffect?(b(),R("div",gt,[s("h3",yt,[e(k(me)),d[4]||(d[4]=l(" 预期达到效果 "))]),s("div",bt,g(o.requirement.expectedEffect),1)])):F("",!0),o.requirement.attachments&&o.requirement.attachments.length?(b(),R("div",qt,[s("h3",kt,[e(k(Se)),d[5]||(d[5]=l(" 相关附件 "))]),s("div",xt,[(b(!0),R(T,null,G(o.requirement.attachments,(v,C)=>(b(),R("div",{key:C,class:"attachment-item"},[e(k(Pe)),s("span",wt,g(v.name),1),e(E,{type:"link",size:"small"},{default:t(()=>d[6]||(d[6]=[l("下载")])),_:1,__:[6]})]))),128))])])):F("",!0),o.requirement.comments&&o.requirement.comments.length?(b(),R("div",Ct,[s("h3",$t,[e(k(ne)),d[7]||(d[7]=l(" 操作历史 "))]),e(p,null,{default:t(()=>[(b(!0),R(T,null,G(o.requirement.comments,(v,C)=>(b(),j(B,{key:C,color:q(v.type)},{default:t(()=>[s("div",Ot,[s("div",Dt,[s("span",Et,g(v.user),1),s("span",St,g(v.time),1)]),s("div",Pt,g(v.action),1),v.comment?(b(),R("div",Rt,g(v.comment),1)):F("",!0)])]),_:2},1032,["color"]))),128))]),_:1})])):F("",!0),s("div",zt,[e(a,null,{default:t(()=>[e(E,{type:"primary",onClick:d[0]||(d[0]=v=>m.$emit("edit",o.requirement))},{default:t(()=>[e(k(te)),d[8]||(d[8]=l(" 编辑需求 "))]),_:1,__:[8]}),e(E,{type:"primary",ghost:"",onClick:d[1]||(d[1]=v=>m.$emit("start-research",o.requirement))},{default:t(()=>[e(k(de)),d[9]||(d[9]=l(" 开始调研 "))]),_:1,__:[9]}),e(E,{onClick:z},{default:t(()=>[e(k(fe)),d[10]||(d[10]=l(" 导出详情 "))]),_:1,__:[10]})]),_:1})])])}}},Mt=W(It,[["__scopeId","data-v-388fd841"]]),Ut={class:"filter-section"},At={class:"total-count-row"},jt={class:"count-num"},Bt={class:"status-board"},Lt={class:"status-header"},Ft={class:"requirement-cards"},ht={key:1,class:"empty-state"},Tt={class:"table-section"},Nt={__name:"index",setup(o){Ie();const u=M([]),c=M([]),_=M(!1),q=M(!1),z=M(null),m=M(null),d=M("board"),i=M(""),O=M(""),U=M(""),E=M(""),B=[{value:"待分析",label:"待分析",color:"#d9d9d9"},{value:"进行中",label:"进行中",color:"#1890ff"},{value:"已完成",label:"已完成",color:"#52c41a"},{value:"已暂停",label:"已暂停",color:"#faad14"}],p=Re(()=>B.filter(f=>S(f.value).length>0)),a=[{title:"需求标题",dataIndex:"title",key:"title",width:200,ellipsis:!0},{title:"需求分类",dataIndex:"category",key:"category",width:120},{title:"优先级",dataIndex:"priority",key:"priority",width:80},{title:"状态",dataIndex:"status",key:"status",width:100},{title:"提出人",dataIndex:"proposer",key:"proposer",width:100},{title:"提出部门",dataIndex:"proposerDept",key:"proposerDept",width:100},{title:"提出时间",dataIndex:"createdAt",key:"createdAt",width:120},{title:"操作",key:"actions",width:180,fixed:"right"}];function v(){u.value=[{id:"REQ001",title:"智能水质监测系统升级",description:"对现有水质监测系统进行智能化升级，增加AI预警功能和大数据分析能力",category:"技术创新",priority:"高",status:"待分析",proposer:"张三",proposerDept:"技术部",createdAt:"2024-01-15",expectedEffect:"提升水质监测精度30%，降低人工成本50%，实现24小时无人值守监测",attachments:[]},{id:"REQ002",title:"污水处理工艺优化研究",description:"研究新型污水处理工艺，提高处理效率，降低能耗",category:"工艺改进",priority:"中",status:"进行中",proposer:"李四",proposerDept:"工艺部",createdAt:"2024-01-20",expectedEffect:"处理效率提升20%，能耗降低15%，污水处理达标率99%以上",attachments:[]},{id:"REQ003",title:"管网漏损检测设备更新",description:"更新老旧的管网漏损检测设备，采用声学检测和压力监测技术",category:"设备更新",priority:"高",status:"已完成",proposer:"王五",proposerDept:"运维部",createdAt:"2024-01-10",expectedEffect:"漏损率降低25%，维护成本减少40%，管网运行稳定性大幅提升",attachments:[]}],c.value=[...u.value]}function C(f){return c.value.filter(n=>n.status===f).length}function S(f){return c.value.filter(n=>n.status===f)}function L(f){return{高:"red",中:"orange",低:"blue"}[f]||"default"}function D(f){return{待分析:"default",进行中:"processing",已完成:"success",已暂停:"warning"}[f]||"default"}function P(){let f=[...u.value];if(i.value&&(f=f.filter(n=>n.status===i.value)),O.value&&(f=f.filter(n=>n.priority===O.value)),U.value&&(f=f.filter(n=>n.category===U.value)),E.value){const n=E.value.toLowerCase();f=f.filter(x=>x.title.toLowerCase().includes(n)||x.description.toLowerCase().includes(n))}c.value=f}function N(f){if(z.value){const n=u.value.findIndex(x=>x.id===z.value.id);u.value[n]={...f},A.success("需求更新成功")}else{const n={...f,id:`REQ${String(u.value.length+1).padStart(3,"0")}`,createdAt:new Date().toISOString().split("T")[0],status:"待分析"};u.value.unshift(n),A.success("需求添加成功")}P(),_.value=!1,z.value=null}function h(f){z.value={...f},_.value=!0}function V(f){const n=u.value.findIndex(x=>x.id===f.id);u.value.splice(n,1),P(),A.success("需求删除成功")}function J(f){m.value=f,q.value=!0}function X(f){const n={...f,id:`REQ${String(u.value.length+1).padStart(3,"0")}`,title:`${f.title} (副本)`,status:"待分析",createdAt:new Date().toISOString().split("T")[0]};u.value.unshift(n),P(),A.success("需求复制成功")}function $(f,n){const x=u.value.find(w=>w.id===f);x&&(x.status=n,P(),A.success(`需求状态已更新为：${n}`))}function ce(f,n){const x=u.value.find(w=>w.id===f);x&&(x.priority=n,P(),A.success(`需求优先级已更新为：${n}`))}function oe(f){$(f.id,"进行中"),A.success("已开始内部评估，请完善评估信息")}function pe(){A.success("需求导出功能开发中...")}function _e(){i.value="",O.value="",U.value="",E.value="",P()}return ze(()=>{v()}),(f,n)=>{const x=r("a-button"),w=r("a-select-option"),Y=r("a-select"),ve=r("a-input-search"),ae=r("a-space"),Z=r("a-col"),ie=r("a-row"),ge=r("a-badge"),ye=r("a-empty"),K=r("a-tag"),ee=r("a-menu-item"),be=r("a-menu-divider"),qe=r("a-menu"),ke=r("a-dropdown"),xe=r("a-table"),we=r("a-drawer");return b(),R(T,null,[e(Te,{title:"需求池管理",description:"项目调研的起点，收集和管理各类研发需求"},{actions:t(()=>[e(x,{type:"primary",onClick:n[0]||(n[0]=y=>_.value=!0)},{default:t(()=>[e(k(Le)),n[7]||(n[7]=l(" 新增需求 "))]),_:1,__:[7]}),e(x,{onClick:pe},{default:t(()=>[e(k(fe)),n[8]||(n[8]=l(" 导出需求 "))]),_:1,__:[8]})]),default:t(()=>[s("div",Ut,[e(ie,{gutter:16},{default:t(()=>[e(Z,{span:18},{default:t(()=>[e(ae,{size:"middle"},{default:t(()=>[e(Y,{value:i.value,"onUpdate:value":n[1]||(n[1]=y=>i.value=y),placeholder:"需求状态",style:{width:"120px"},onChange:P},{default:t(()=>[e(w,{value:""},{default:t(()=>n[9]||(n[9]=[l("全部状态")])),_:1,__:[9]}),e(w,{value:"待分析"},{default:t(()=>n[10]||(n[10]=[l("待分析")])),_:1,__:[10]}),e(w,{value:"进行中"},{default:t(()=>n[11]||(n[11]=[l("进行中")])),_:1,__:[11]}),e(w,{value:"已完成"},{default:t(()=>n[12]||(n[12]=[l("已完成")])),_:1,__:[12]}),e(w,{value:"已暂停"},{default:t(()=>n[13]||(n[13]=[l("已暂停")])),_:1,__:[13]})]),_:1},8,["value"]),e(Y,{value:O.value,"onUpdate:value":n[2]||(n[2]=y=>O.value=y),placeholder:"优先级",style:{width:"100px"},onChange:P},{default:t(()=>[e(w,{value:""},{default:t(()=>n[14]||(n[14]=[l("全部")])),_:1,__:[14]}),e(w,{value:"高"},{default:t(()=>n[15]||(n[15]=[l("高")])),_:1,__:[15]}),e(w,{value:"中"},{default:t(()=>n[16]||(n[16]=[l("中")])),_:1,__:[16]}),e(w,{value:"低"},{default:t(()=>n[17]||(n[17]=[l("低")])),_:1,__:[17]})]),_:1},8,["value"]),e(Y,{value:U.value,"onUpdate:value":n[3]||(n[3]=y=>U.value=y),placeholder:"需求分类",style:{width:"120px"},onChange:P},{default:t(()=>[e(w,{value:""},{default:t(()=>n[18]||(n[18]=[l("全部分类")])),_:1,__:[18]}),e(w,{value:"技术创新"},{default:t(()=>n[19]||(n[19]=[l("技术创新")])),_:1,__:[19]}),e(w,{value:"工艺改进"},{default:t(()=>n[20]||(n[20]=[l("工艺改进")])),_:1,__:[20]}),e(w,{value:"设备更新"},{default:t(()=>n[21]||(n[21]=[l("设备更新")])),_:1,__:[21]}),e(w,{value:"质量提升"},{default:t(()=>n[22]||(n[22]=[l("质量提升")])),_:1,__:[22]}),e(w,{value:"成本控制"},{default:t(()=>n[23]||(n[23]=[l("成本控制")])),_:1,__:[23]})]),_:1},8,["value"]),e(ve,{value:E.value,"onUpdate:value":n[4]||(n[4]=y=>E.value=y),placeholder:"搜索需求标题或描述",style:{width:"250px"},onSearch:P},null,8,["value"])]),_:1})]),_:1}),e(Z,{span:6},{default:t(()=>[s("div",At,[n[24]||(n[24]=s("span",null,"需求总数",-1)),s("span",jt,g(u.value.length),1)])]),_:1})]),_:1})]),s("div",Bt,[p.value.length>0?(b(),j(ie,{key:0,gutter:16,class:"card-list"},{default:t(()=>[(b(!0),R(T,null,G(p.value,y=>(b(),j(Z,{key:y.value,span:6},{default:t(()=>[s("div",{class:Ue(["status-column",`status-${y.color}`])},[s("div",Lt,[s("h3",null,g(y.label),1),e(ge,{count:C(y.value),"number-style":{backgroundColor:y.color}},null,8,["count","number-style"])]),s("div",Ft,[(b(!0),R(T,null,G(S(y.value),I=>(b(),j(rt,{key:I.id,requirement:I,onEdit:h,onDelete:V,onStatusChange:$,onPriorityChange:ce},null,8,["requirement"]))),128))])],2)]),_:2},1024))),128))]),_:1})):(b(),R("div",ht,[e(ye,{description:"没有找到符合条件的需求",image:k(Ae).PRESENTED_IMAGE_SIMPLE},{default:t(()=>[e(x,{type:"primary",onClick:_e},{default:t(()=>n[25]||(n[25]=[l("清除筛选条件")])),_:1,__:[25]})]),_:1},8,["image"])]))]),Me(s("div",Tt,[e(xe,{columns:a,"data-source":c.value,pagination:{pageSize:10},scroll:{x:1200},"row-key":"id"},{bodyCell:t(({column:y,record:I})=>[y.key==="priority"?(b(),j(K,{key:0,color:L(I.priority)},{default:t(()=>[l(g(I.priority),1)]),_:2},1032,["color"])):y.key==="status"?(b(),j(K,{key:1,color:D(I.status)},{default:t(()=>[l(g(I.status),1)]),_:2},1032,["color"])):y.key==="category"?(b(),j(K,{key:2},{default:t(()=>[l(g(I.category),1)]),_:2},1024)):y.key==="actions"?(b(),j(ae,{key:3},{default:t(()=>[e(x,{type:"link",size:"small",onClick:H=>h(I)},{default:t(()=>n[26]||(n[26]=[l(" 编辑 ")])),_:2,__:[26]},1032,["onClick"]),e(x,{type:"link",size:"small",onClick:H=>oe(I)},{default:t(()=>n[27]||(n[27]=[l(" 开始调研 ")])),_:2,__:[27]},1032,["onClick"]),e(ke,null,{overlay:t(()=>[e(qe,null,{default:t(()=>[e(ee,{onClick:H=>J(I)},{default:t(()=>n[28]||(n[28]=[l("查看详情")])),_:2,__:[28]},1032,["onClick"]),e(ee,{onClick:H=>X(I)},{default:t(()=>n[29]||(n[29]=[l("复制需求")])),_:2,__:[29]},1032,["onClick"]),e(be),e(ee,{onClick:H=>V(I),style:{color:"#ff4d4f"}},{default:t(()=>n[30]||(n[30]=[l(" 删除需求 ")])),_:2,__:[30]},1032,["onClick"])]),_:2},1024)]),default:t(()=>[e(x,{type:"link",size:"small"},{default:t(()=>[n[31]||(n[31]=l(" 更多 ")),e(k(je))]),_:1,__:[31]})]),_:2},1024)]),_:2},1024)):F("",!0)]),_:1},8,["data-source"])],512),[[Be,d.value==="table"]])]),_:1}),e(dt,{visible:_.value,"onUpdate:visible":n[5]||(n[5]=y=>_.value=y),requirement:z.value,onSave:N},null,8,["visible","requirement"]),e(we,{open:q.value,"onUpdate:open":n[6]||(n[6]=y=>q.value=y),title:"需求详情",width:"600",placement:"right"},{default:t(()=>[m.value?(b(),j(Mt,{key:0,requirement:m.value,onEdit:h,onStartResearch:oe},null,8,["requirement"])):F("",!0)]),_:1},8,["open"])],64)}}},Xt=W(Nt,[["__scopeId","data-v-8e7d7965"]]);export{Xt as default};
