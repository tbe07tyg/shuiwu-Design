import{_ as Ft,a as x,c as oe,o as It,b as S,d as l,e as t,j as o,m as c,w as s,g as k,K as Mt,N as Tt,h as $t,i as p,F as Ot,t as u,q as fe,B as _e,C as ue,Q as qt,f as R,p as f,v as Z,x as de,V as ee,J as te,n as re,H as $,E as Ut,y as Bt,T as je,k as y}from"./index-XOIS1SV9.js";import{U as Dt,F as Pt}from"./FilePreview-CcGFJpWX.js";import{A as Et}from"./AppstoreOutlined-Byzbna9m.js";import{B as ze}from"./BulbOutlined-DZEqlzpn.js";import{A as ge}from"./AuditOutlined-zVkhJeET.js";import{U as he}from"./UploadOutlined-BeZhUyI8.js";import{F as Vt}from"./FileSearchOutlined-BYFTh-3I.js";/* empty css                                                                    */import"./ExportOutlined-DgwVHsvH.js";const Lt={class:"approval-management-center"},Ht={class:"page-header"},At={class:"header-content"},Jt={class:"page-title"},Wt={class:"title-icon"},Yt={class:"header-actions"},Kt={class:"stats-overview"},Nt={class:"stat-icon"},Qt={class:"stat-content"},Gt={class:"stat-number"},Xt={class:"stat-icon"},Zt={class:"stat-content"},el={class:"stat-number"},tl={class:"stat-icon"},ll={class:"stat-content"},sl={class:"stat-number"},al={class:"stat-icon"},il={class:"stat-content"},nl={class:"stat-number"},ol={class:"stat-icon"},ul={class:"stat-content"},dl={class:"stat-number"},rl={class:"stat-icon"},vl={class:"stat-content"},pl={class:"stat-number"},cl={class:"content-card flow-description"},ml={class:"card-header"},fl={class:"flow-content"},_l={class:"step-description"},gl={class:"step-status-tags"},wl={class:"step-description"},yl={class:"step-status-tags"},bl={class:"step-description"},kl={class:"step-status-tags"},Sl={class:"content-card"},xl={class:"card-header"},Cl={class:"header-filters"},Rl={class:"project-review-list"},jl={key:1,class:"text-muted"},zl={key:0,class:"review-modal"},hl={class:"project-basic-info"},Fl={class:"material-review-section"},Il={class:"section-header"},Ml={class:"batch-actions"},Tl={class:"material-list"},$l={class:"material-info"},Ol={class:"material-name"},ql={class:"material-type"},Ul={class:"material-actions"},Bl={class:"material-review-controls"},Dl={class:"review-status-display"},Pl=["onClick"],El={class:"status-icon"},Vl=["onClick"],Ll={class:"status-icon"},Hl={class:"status-icon"},Al={key:0,class:"edit-opinion-btn"},Jl={key:0,class:"rejection-reason"},Wl={class:"reason-content"},Yl={class:"review-comments-section"},Kl={class:"section-header"},Nl={class:"comments-tip"},Ql={class:"review-result-section"},Gl={class:"auto-result-display"},Xl={key:0,class:"rejection-details"},Zl={class:"modal-footer"},es={key:0,class:"rejection-form"},ts={class:"material-info"},ls={class:"material-type"},ss={key:0,class:"meeting-modal"},as={class:"meeting-materials"},is={key:0,class:"materials-list"},ns={class:"file-name"},os={class:"file-size"},us={key:0,class:"result-modal"},ds={class:"project-meeting-info"},rs={class:"conclusion-files"},vs={key:0,class:"files-list"},ps={class:"file-name"},cs={class:"file-size"},ms={key:0,class:"improvement-review-modal"},fs={class:"project-basic-info"},_s={key:0,class:"original-requirements"},gs={class:"requirements-content"},ws={class:"improvement-materials"},ys={class:"improvement-materials-list"},bs={class:"material-item improvement-material"},ks={class:"material-info"},Ss={class:"material-name"},xs={class:"material-meta"},Cs={class:"material-time"},Rs={class:"material-actions"},js={class:"material-item improvement-material"},zs={class:"material-info"},hs={class:"material-name"},Fs={class:"material-meta"},Is={class:"material-time"},Ms={class:"material-actions"},Ts={class:"material-item improvement-material"},$s={class:"material-info"},Os={class:"material-name"},qs={class:"material-meta"},Us={class:"material-time"},Bs={class:"material-actions"},Ds={class:"improvement-description"},Ps={class:"description-content"},Es={class:"improvement-content"},Vs={class:"improvement-details"},Ls={class:"improvement-submit-info"},Hs={class:"review-result-section"},As={key:0,class:"detail-modal"},Js={class:"detail-section"},Ws={class:"detail-section"},Ys={class:"material-list"},Ks={class:"material-info"},Ns={class:"material-name"},Qs={class:"material-meta"},Gs={class:"material-type"},Xs={class:"material-actions"},Zs={key:0,class:"detail-section"},ea={key:1,class:"detail-section"},ta={class:"requirements-text"},la={key:2,class:"detail-section"},sa={class:"improvement-text"},aa={class:"detail-section"},ia={class:"timeline-content"},na={class:"timeline-time"},oa={class:"timeline-content"},ua={class:"timeline-time"},da={class:"timeline-content"},ra={class:"timeline-time"},va={class:"timeline-content"},pa={class:"timeline-title"},ca={class:"timeline-time"},ma={class:"timeline-content"},fa={class:"timeline-time"},_a={__name:"center",setup(ga){$t();const v=x([{id:1,name:"智慧城市大数据平台建设项目",code:"PROJ-2024-001",year:"2024",applicant:"王五",department:"技术部",duration:18,budget:200,currentStatus:"material_reviewing",materialStatus:"reviewing",meetingStatus:"pending",finalResult:null,submitTime:"2024-01-15",meetingScheduled:!1,materials:[{id:1,name:"项目验收报告.pdf",type:"验收报告",size:25e5,url:"/api/files/download/项目验收报告.pdf",reviewStatus:"pending"},{id:2,name:"项目总结报告.docx",type:"总结报告",size:12e5,url:"/api/files/download/项目总结报告.docx",reviewStatus:"pending"},{id:3,name:"成果汇总材料.zip",type:"成果材料",size:85e5,url:"/api/files/download/成果汇总材料.zip",reviewStatus:"pending"}]},{id:2,name:"区块链供应链金融平台",code:"PROJ-2024-002",year:"2024",applicant:"赵六",department:"工程部",duration:12,budget:150,currentStatus:"meeting_preparing",materialStatus:"approved",meetingStatus:"preparing",finalResult:null,submitTime:"2024-01-20",meetingScheduled:!1,materials:[{id:4,name:"项目验收报告.pdf",type:"验收报告",size:18e5,url:"/api/files/download/项目验收报告.pdf",reviewStatus:"approved"},{id:5,name:"财务决算报告.xlsx",type:"财务报告",size:5e5,url:"/api/files/download/财务决算报告.xlsx",reviewStatus:"approved"}]},{id:3,name:"物联网环境监测系统",code:"PROJ-2024-003",year:"2024",applicant:"李明",department:"自动化部",duration:24,budget:180,currentStatus:"meeting_scheduled",materialStatus:"approved",meetingStatus:"scheduled",finalResult:null,submitTime:"2024-01-12",meetingScheduled:!0,meetingInfo:{time:"2024-01-25 14:00",location:"会议室A301",type:"offline",description:"项目验收会议，重点评审环境监测系统的技术实现"},materials:[{id:6,name:"项目验收报告.pdf",type:"验收报告",size:25e5,url:"/api/files/download/项目验收报告.pdf",reviewStatus:"approved"},{id:7,name:"系统测试报告.pdf",type:"测试报告",size:15e5,url:"/api/files/download/系统测试报告.pdf",reviewStatus:"approved"}]},{id:4,name:"电子商务数据分析系统",code:"PROJ-2024-004",year:"2024",applicant:"王强",department:"信息部",duration:15,budget:220,currentStatus:"approval_passed",materialStatus:"approved",meetingStatus:"completed",finalResult:"passed",submitTime:"2024-01-08",meetingScheduled:!0,meetingInfo:{time:"2024-01-22 09:00",location:"会议室B205",type:"offline",description:"项目验收会议，邀请相关专家进行评审"},materials:[{id:8,name:"项目验收报告.pdf",type:"验收报告",size:25e5,url:"/api/files/download/项目验收报告.pdf",reviewStatus:"approved"}],conclusion:{result:"passed",score:92,time:"2024-01-22",description:"项目验收通过，系统功能完整，技术指标达标。"}},{id:5,name:"在线教育管理平台",code:"PROJ-2024-005",year:"2024",applicant:"张华",department:"教育部",duration:20,budget:160,currentStatus:"approval_conditional",materialStatus:"approved",meetingStatus:"completed",finalResult:"conditional_passed",submitTime:"2024-01-03",meetingScheduled:!0,meetingInfo:{time:"2024-01-21 14:30",location:"会议室C102",type:"hybrid",description:"项目验收会议，采用线上线下结合的方式进行"},materials:[{id:9,name:"项目验收报告.pdf",type:"验收报告",size:25e5,url:"/api/files/download/项目验收报告.pdf",reviewStatus:"approved"},{id:10,name:"用户操作手册.pdf",type:"用户手册",size:8e5,url:"/api/files/download/用户操作手册.pdf",reviewStatus:"approved"},{id:11,name:"数据备份机制说明.pdf",type:"整改材料",size:6e5,url:"/api/files/download/数据备份机制说明.pdf",reviewStatus:"pending"},{id:12,name:"系统界面优化报告.docx",type:"整改材料",size:12e5,url:"/api/files/download/系统界面优化报告.docx",reviewStatus:"pending"},{id:13,name:"技术文档补充.zip",type:"整改材料",size:5e6,url:"/api/files/download/技术文档补充.zip",reviewStatus:"pending"}],conclusion:{result:"conditional_passed",score:82,time:"2024-01-21",description:"项目基本达到验收要求，有条件通过验收。",requirements:"1. 完善数据备份机制；2. 优化系统界面布局；3. 30天内提交整改确认。"},improvementSubmitted:!0,improvementSubmitTime:"2024-01-28",improvementDescription:`针对验收会议提出的整改要求，我们已完成以下工作：
1. 完善了数据备份机制，增加了自动备份和手动备份功能
2. 优化了系统界面布局，提升用户交互体验
3. 补充了相关技术文档和用户手册
请审核相关材料，如有问题请及时反馈。`},{id:6,name:"移动办公应用系统",code:"PROJ-2024-006",year:"2024",applicant:"刘涛",department:"移动部",duration:14,budget:130,currentStatus:"approval_failed",materialStatus:"approved",meetingStatus:"completed",finalResult:"failed",submitTime:"2024-01-05",meetingScheduled:!0,meetingInfo:{time:"2024-01-20 10:00",location:"会议室A108",type:"offline",description:"项目验收会议，重点关注系统稳定性和功能完整性"},materials:[{id:14,name:"项目验收报告.pdf",type:"验收报告",size:25e5,url:"/api/files/download/项目验收报告.pdf",reviewStatus:"approved"}],conclusion:{result:"failed",score:68,time:"2024-01-20",description:"项目验收未通过，系统稳定性有待提升，需要完善相关功能。",requirements:"1. 优化系统性能；2. 完善用户界面；3. 补充测试文档。"}}]),P=oe(()=>{const a=v.value.filter(g=>g.currentStatus==="material_reviewing").length,e=v.value.filter(g=>g.currentStatus==="meeting_preparing").length,d=v.value.filter(g=>g.currentStatus==="meeting_scheduled").length,r=v.value.filter(g=>g.currentStatus==="approval_passed").length,C=v.value.filter(g=>g.currentStatus==="approval_conditional").length,j=v.value.filter(g=>g.currentStatus==="approval_failed").length;return{materialReviewing:a,meetingPreparing:e,meetingScheduled:d,approvalPassed:r,approvalConditional:C,approvalFailed:j}}),I=x({status:"",keyword:""}),le=x(!1);x([{id:1,name:"张教授",title:"高级工程师"},{id:2,name:"李博士",title:"技术专家"},{id:3,name:"王主任",title:"项目管理专家"}]);const Fe=x([{value:"张教授",label:"张教授"},{value:"李博士",label:"李博士"},{value:"王主任",label:"王主任"},{value:"陈院长",label:"陈院长"},{value:"刘处长",label:"刘处长"}]),Ie=x([{value:"张教授",label:"张教授"},{value:"李博士",label:"李博士"},{value:"王主任",label:"王主任"},{value:"陈院长",label:"陈院长"},{value:"刘处长",label:"刘处长"},{value:"赵专家",label:"赵专家"},{value:"钱专家",label:"钱专家"},{value:"孙专家",label:"孙专家"},{value:"李专家",label:"李专家"}]),Me=[{title:"年度",dataIndex:"year",key:"year",width:80},{title:"立项名称",dataIndex:"name",key:"name",width:200},{title:"申请人",dataIndex:"applicant",key:"applicant",width:100},{title:"申请单位",dataIndex:"department",key:"department",width:120},{title:"项目周期(月)",dataIndex:"duration",key:"duration",width:100},{title:"预算(万元)",dataIndex:"budget",key:"budget",width:100},{title:"状态",key:"currentStatus",width:120},{title:"立项结论",key:"finalResult",width:120},{title:"申请时间",dataIndex:"submitTime",width:120},{title:"操作",key:"actions",width:200,fixed:"right"}],we=x({current:1,pageSize:10,total:0,showSizeChanger:!0,showQuickJumper:!0,showTotal:a=>`共 ${a} 条记录`}),E=x(!1),W=x(!1),Y=x(!1),K=x(!1),se=x(!1),n=x(null),h=x({comments:"",result:"approved",rejectionReason:""}),ae=x(new Map),N=x(!1),V=x(!1),M=x(null),O=x({reason:""}),b=x({datetime:void 0,location:"",type:"offline",hosts:[],experts:[],materials:[],description:""}),w=x({conclusion:"passed",score:85,description:"",requirements:"",conclusionFiles:[]}),T=x({result:"approved",comments:"",requirements:""}),ve=x(!1),ye=x({}),Te=oe(()=>{let a=v.value;return I.value.status&&(a=a.filter(e=>e.currentStatus===I.value.status)),I.value.keyword&&(a=a.filter(e=>e.name.includes(I.value.keyword)||e.code.includes(I.value.keyword))),we.value.total=a.length,a}),$e=oe(()=>{var a;return(a=n.value)!=null&&a.materials?n.value.materials.some(e=>e.reviewStatus&&e.reviewStatus!=="pending"):!1}),ie=oe(()=>{var e,d;return(d=(e=n.value)==null?void 0:e.materials)!=null&&d.length&&n.value.materials.some(r=>r.reviewStatus==="rejected")?"rejected":"approved"}),Oe=a=>({passed:"green",conditional_passed:"orange",failed:"red"})[a]||"default",qe=a=>({passed:"立项通过",conditional_passed:"有条件通过",failed:"立项未通过"})[a]||"待定",be=a=>({material_reviewing:"orange",meeting_preparing:"blue",meeting_scheduled:"cyan",approval_passed:"green",approval_conditional:"orange",approval_failed:"red"})[a]||"default",ke=a=>({material_reviewing:"材料审核中",meeting_preparing:"会议待组织",meeting_scheduled:"会议已安排",approval_passed:"立项通过",approval_conditional:"有条件通过",approval_failed:"立项未通过"})[a]||"未知状态",Ue=()=>{y.info("批量审核功能")},Be=()=>{},De=()=>{},Pe=a=>{n.value=a,ae.value.clear(),N.value=!1,a.materials&&a.materials.forEach(e=>{ae.value.set(e.id,{reviewStatus:e.reviewStatus||"pending",rejectionReason:e.rejectionReason||"",showFullReason:e.showFullReason||!1}),e.reviewStatus||(e.reviewStatus="pending"),e.rejectionReason||(e.rejectionReason="")}),h.value={comments:"",result:ie.value,rejectionReason:""},H(),E.value=!0},Ee=a=>{n.value=a,b.value={datetime:void 0,location:"",type:"offline",experts:[],description:""},W.value=!0},Ve=a=>{n.value=a,w.value={conclusion:"passed",score:85,description:"",requirements:"",conclusionFiles:[]},Y.value=!0},Le=a=>{n.value=a,se.value=!0},He=()=>{se.value=!1},Ae=()=>{G()?je.confirm({title:"确认放弃审核？",content:"您已对材料进行了审核操作，是否确定放弃本次审核并恢复到审核前状态？",okText:"确定放弃",cancelText:"继续审核",okType:"danger",onOk(){pt(),E.value=!1,y.info("已恢复到审核前状态")},onCancel(){}}):E.value=!1},Je=()=>{var e,d;if(!h.value.comments.trim()){y.error("请填写审核意见");return}const a=((d=(e=n.value)==null?void 0:e.materials)==null?void 0:d.filter(r=>r.reviewStatus==="rejected"))||[];if(a.length>0&&!a.every(C=>{var j;return(j=C.rejectionReason)==null?void 0:j.trim()})){y.error("存在被驳回的材料但未填写驳回原因，请完善后提交");return}if(h.value.result=ie.value,y.success("材料审核完成"),E.value=!1,n.value){const r=v.value.findIndex(C=>C.id===n.value.id);if(r!==-1){const C=new Date().toISOString().split("T")[0];h.value.result==="approved"?(v.value[r].currentStatus="meeting_preparing",v.value[r].materialStatus="approved",v.value[r].meetingStatus="preparing",v.value[r].reviewHistory=v.value[r].reviewHistory||[],v.value[r].reviewHistory.push({type:"material_review",result:"approved",comments:h.value.comments,time:C,reviewer:"当前管理员"}),y.success("材料审核通过，项目进入会议组织阶段")):(v.value[r].currentStatus="material_reviewing",v.value[r].materialStatus="rejected",v.value[r].materialRejected=!0,v.value[r].rejectionInfo={time:C,reviewer:"当前管理员",comments:h.value.comments,rejectionReason:h.value.comments},v.value[r].reviewHistory=v.value[r].reviewHistory||[],v.value[r].reviewHistory.push({type:"material_review",result:"rejected",comments:h.value.comments,rejectionReason:h.value.comments,time:C,reviewer:"当前管理员"}),y.warning("材料审核不通过，已通知申请人根据意见重新提交材料")),v.value[r].materials&&v.value[r].materials.forEach(j=>{j.reviewStatus&&j.reviewStatus!=="pending"&&(j.reviewTime=C,j.reviewer="当前管理员")})}}},We=()=>{var a;if(y.success("会议安排完成"),W.value=!1,n.value){const e=v.value.findIndex(d=>d.id===n.value.id);e!==-1&&(v.value[e].currentStatus="meeting_scheduled",v.value[e].meetingStatus="scheduled",v.value[e].meetingScheduled=!0,v.value[e].meetingInfo={time:(a=b.value.datetime)==null?void 0:a.format("YYYY-MM-DD HH:mm"),location:b.value.location,type:b.value.type,experts:b.value.experts,description:b.value.description})}},Ye=()=>{W.value=!1},Ke=(a,e)=>e.label.toLowerCase().indexOf(a.toLowerCase())>=0,Ne=(a,e)=>e.label.toLowerCase().indexOf(a.toLowerCase())>=0,Qe=a=>["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-rar-compressed"].includes(a.type)?(a.size/1024/1024<50||y.error("文件大小不能超过50MB！"),!1):(y.error("请上传PDF、Word、PPT、Excel或压缩包格式的文件！"),!1),Ge=a=>{const e=b.value.materials.findIndex(d=>d.uid===a.uid);e>-1&&b.value.materials.splice(e,1)},Xe=a=>{b.value.materials.splice(a,1)},Se=a=>a<1024?a+" B":a<1024*1024?Math.round(a/1024)+" KB":Math.round(a/(1024*1024))+" MB",Ze=a=>a.size/1024/1024<20?!["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(a.type)&&!a.name.match(/\.(pdf|doc|docx|xls|xlsx)$/i)?(y.error("只支持PDF、Word、Excel格式!"),!1):(w.value.conclusionFiles.push(a),y.success(`文件 ${a.name} 添加成功`),!1):(y.error("文件大小不能超过20MB!"),!1),et=a=>{const e=w.value.conclusionFiles.findIndex(d=>d.uid===a.uid);e>-1&&w.value.conclusionFiles.splice(e,1)},tt=a=>{w.value.conclusionFiles.splice(a,1),y.success("文件删除成功")},lt=()=>{if(!w.value.conclusion){y.error("请选择验收结论");return}if(!w.value.description){y.error("请填写结论说明");return}if(w.value.conclusion!=="passed"&&!w.value.requirements){y.error("请填写整改要求");return}if(y.success("验收结论录入完成"),Y.value=!1,n.value){const a=v.value.findIndex(e=>e.id===n.value.id);if(a!==-1){switch(v.value[a].finalResult=w.value.conclusion,v.value[a].meetingStatus="completed",w.value.conclusion){case"passed":v.value[a].currentStatus="approval_passed";break;case"conditional_passed":v.value[a].currentStatus="approval_conditional";break;case"failed":v.value[a].currentStatus="approval_failed";break}v.value[a].conclusion={result:w.value.conclusion,score:w.value.score,description:w.value.description,requirements:w.value.requirements,conclusionFiles:w.value.conclusionFiles,time:new Date().toISOString().split("T")[0]}}}},st=()=>{Y.value=!1},at=()=>{const a=T.value.result,e=T.value.comments.trim(),d=T.value.requirements.trim();if(!e){y.error("请填写审核意见");return}if(a==="rejected"&&!d){y.error("审核不通过时，请填写新的整改要求");return}if(n.value){const r=v.value.findIndex(C=>C.id===n.value.id);if(r!==-1){const C=new Date().toISOString().split("T")[0];a==="approved"?(v.value[r].currentStatus="approval_passed",v.value[r].finalResult="passed",v.value[r].conclusion={...v.value[r].conclusion,result:"passed",rectificationConfirmed:!0,rectificationTime:C,rectificationComments:e,rectificationRejected:!1},v.value[r].improvementSubmitted=!0,y.success("整改材料审核通过，项目验收完成！")):(v.value[r].conclusion={...v.value[r].conclusion,rectificationRejected:!0,rectificationRejectTime:C,rectificationRejectComments:e,newRequirements:d,result:"conditional_passed"},y.warning("整改材料审核不通过，已记录新的整改要求，申请人需要重新提交整改材料"))}}K.value=!1},it=()=>{K.value=!1},Q=a=>{ye.value={id:a.id,name:a.name,type:a.type,size:a.size||ot(a.name),url:xe(a.name),uploadTime:a.uploadTime||"2024-01-15 10:30"},ve.value=!0},L=a=>{const e=document.createElement("a");e.href=xe(a.name),e.download=a.name,e.click(),y.success(`正在下载：${a.name}`)},nt=a=>{L(a)},ot=a=>a.includes(".pdf")?2.5*1024*1024:a.includes(".docx")?1.2*1024*1024:a.includes(".pptx")?3.8*1024*1024:a.includes(".zip")?8.5*1024*1024:1.5*1024*1024,xe=a=>`/api/files/download/${encodeURIComponent(a)}`,ut=a=>{a.reviewStatus="approved",a.rejectionReason="",G(),H(),y.success(`材料 "${a.name}" 审核通过`)},dt=a=>{M.value=a,O.value.reason=a.rejectionReason||"",V.value=!0},rt=a=>{M.value=a,O.value.reason=a.rejectionReason||"",V.value=!0},vt=a=>{a.showFullReason=!a.showFullReason},G=()=>{var a;if(!((a=n.value)!=null&&a.materials))return N.value=!1,!1;for(const e of n.value.materials){const d=ae.value.get(e.id);if(d&&(e.reviewStatus!==d.reviewStatus||e.rejectionReason!==d.rejectionReason))return N.value=!0,!0}return N.value=!1,!1},pt=()=>{var a;(a=n.value)!=null&&a.materials&&(n.value.materials.forEach(e=>{const d=ae.value.get(e.id);d&&(e.reviewStatus=d.reviewStatus,e.rejectionReason=d.rejectionReason,e.showFullReason=d.showFullReason)}),N.value=!1)},ct=()=>{if(!O.value.reason.trim()){y.error("请填写驳回原因");return}M.value&&(M.value.reviewStatus="rejected",M.value.rejectionReason=O.value.reason,G(),H(),y.success(`材料 "${M.value.name}" 已驳回`)),V.value=!1,M.value=null,O.value.reason=""},mt=()=>{V.value=!1,M.value=null,O.value.reason=""},ft=()=>{var a,e;(e=(a=n.value)==null?void 0:a.materials)!=null&&e.length&&(n.value.materials.forEach(d=>{d.reviewStatus="approved",d.rejectionReason=""}),G(),H(),y.success("已将所有材料设为通过"))},_t=()=>{var a,e;(e=(a=n.value)==null?void 0:a.materials)!=null&&e.length&&(n.value.materials.forEach(d=>{d.reviewStatus="rejected",d.rejectionReason||(d.rejectionReason="请参考整体审核意见进行修改")}),G(),H(),y.warning("已将所有材料设为驳回，请在审核意见中补充详细的驳回原因"))},gt=()=>{H(),y.success("审核意见已重新生成")},H=()=>{var e,d;if(!((d=(e=n.value)==null?void 0:e.materials)!=null&&d.length))return;const a=[];if(n.value.materials.forEach(r=>{r.reviewStatus==="approved"?a.push(`${r.name} - 审核通过`):r.reviewStatus==="rejected"&&r.rejectionReason&&a.push(`${r.name} - 驳回原因：${r.rejectionReason}`)}),a.length>0){const r=h.value.comments,C=a.join(`
`);if(!r.includes(C)){const j=r.split(`
`).filter(g=>!g.includes(" - 审核通过")&&!g.includes(" - 驳回原因：")).join(`
`).trim();h.value.comments=C+(j?`

`+j:"")}}},wt=a=>{n.value=a,T.value={result:"approved",comments:"",requirements:""},K.value=!0},yt=a=>{n.value=a,je.confirm({title:"重新审核",content:`确认对项目"${a.name}"进行重新审核？这将重置项目状态到材料审核阶段。`,okText:"确认重审",cancelText:"取消",onOk(){const e=v.value.findIndex(d=>d.id===a.id);e!==-1&&(v.value[e].currentStatus="material_reviewing",v.value[e].materialStatus="reviewing",v.value[e].meetingStatus="pending",v.value[e].finalResult=null,delete v.value[e].conclusion,y.success("项目已重置为材料审核阶段，可重新开始审核流程"))}})},bt=()=>{le.value=!le.value},A=a=>{I.value.keyword="",I.value.status=a};return It(()=>{}),(a,e)=>{const d=k("a-button"),r=k("a-col"),C=k("a-row"),j=k("a-step"),g=k("a-tag"),kt=k("a-steps"),B=k("a-select-option"),pe=k("a-select"),St=k("a-input-search"),ce=k("a-space"),xt=k("a-table"),_=k("a-descriptions-item"),D=k("a-descriptions"),q=k("a-textarea"),Ce=k("a-alert"),z=k("a-form-item"),J=k("a-modal"),ne=k("a-form"),Ct=k("a-date-picker"),Rt=k("a-input"),U=k("a-radio"),me=k("a-radio-group"),Re=k("a-upload"),jt=k("a-input-number"),zt=k("a-card"),X=k("a-timeline-item"),ht=k("a-timeline");return p(),S("div",Lt,[l("div",Ht,[l("div",At,[l("h1",Jt,[l("span",Wt,[t(c(Et))]),e[39]||(e[39]=o(" 立项管理中心 "))]),e[40]||(e[40]=l("p",{class:"page-description"}," 审核立项材料，组织立项会议，管理立项流程 ",-1))]),l("div",Yt,[t(d,{type:"primary",onClick:Ue},{default:s(()=>[t(c(ge)),e[41]||(e[41]=o(" 批量审核 "))]),_:1,__:[41]})])]),l("div",Kt,[t(C,{gutter:16},{default:s(()=>[t(r,{xs:12,sm:8,md:6,lg:4,xl:4},{default:s(()=>[l("div",{class:"stat-card pending",onClick:e[0]||(e[0]=i=>A("material_reviewing"))},[l("div",Nt,[t(c(Ot))]),l("div",Qt,[l("div",Gt,u(P.value.materialReviewing),1),e[42]||(e[42]=l("div",{class:"stat-label"},"材料审核中",-1))])])]),_:1}),t(r,{xs:12,sm:8,md:6,lg:4,xl:4},{default:s(()=>[l("div",{class:"stat-card reviewing",onClick:e[1]||(e[1]=i=>A("meeting_preparing"))},[l("div",Xt,[t(c(fe))]),l("div",Zt,[l("div",el,u(P.value.meetingPreparing),1),e[43]||(e[43]=l("div",{class:"stat-label"},"会议待组织",-1))])])]),_:1}),t(r,{xs:12,sm:8,md:6,lg:4,xl:4},{default:s(()=>[l("div",{class:"stat-card scheduled",onClick:e[2]||(e[2]=i=>A("meeting_scheduled"))},[l("div",tl,[t(c(_e))]),l("div",ll,[l("div",sl,u(P.value.meetingScheduled),1),e[44]||(e[44]=l("div",{class:"stat-label"},"会议已安排",-1))])])]),_:1}),t(r,{xs:12,sm:8,md:6,lg:4,xl:4},{default:s(()=>[l("div",{class:"stat-card completed",onClick:e[3]||(e[3]=i=>A("approval_passed"))},[l("div",al,[t(c(ue))]),l("div",il,[l("div",nl,u(P.value.approvalPassed),1),e[45]||(e[45]=l("div",{class:"stat-label"},"立项通过",-1))])])]),_:1}),t(r,{xs:12,sm:8,md:6,lg:4,xl:4},{default:s(()=>[l("div",{class:"stat-card conditional",onClick:e[4]||(e[4]=i=>A("approval_conditional"))},[l("div",ol,[t(c(ze))]),l("div",ul,[l("div",dl,u(P.value.approvalConditional),1),e[46]||(e[46]=l("div",{class:"stat-label"},"有条件通过",-1))])])]),_:1}),t(r,{xs:12,sm:8,md:6,lg:4,xl:4},{default:s(()=>[l("div",{class:"stat-card rejected",onClick:e[5]||(e[5]=i=>A("approval_failed"))},[l("div",rl,[t(c(qt))]),l("div",vl,[l("div",pl,u(P.value.approvalFailed),1),e[47]||(e[47]=l("div",{class:"stat-label"},"立项未通过",-1))])])]),_:1})]),_:1})]),l("div",cl,[l("div",ml,[l("h3",null,[t(c(ze)),e[48]||(e[48]=o(" 立项流程说明 "))]),t(d,{type:"link",size:"small",onClick:bt},{default:s(()=>[o(u(le.value?"收起":"展开"),1)]),_:1})]),Mt(l("div",fl,[t(kt,{current:3,size:"small",direction:"horizontal",status:"finish"},{default:s(()=>[t(j,{title:"申请提交",description:"申报单位提交立项申请",status:"finish"}),t(j,{title:"材料审核",status:"finish"},{description:s(()=>[l("div",_l,[e[50]||(e[50]=o(" 审核立项材料，决定通过或驳回 ")),l("div",gl,[t(g,{color:"orange",size:"small"},{default:s(()=>e[49]||(e[49]=[o("材料审核中")])),_:1,__:[49]})])])]),_:1}),t(j,{title:"组织会议",status:"finish"},{description:s(()=>[l("div",wl,[e[53]||(e[53]=o(" 安排立项会议并组织专家评审 ")),l("div",yl,[t(g,{color:"blue",size:"small"},{default:s(()=>e[51]||(e[51]=[o("会议待组织")])),_:1,__:[51]}),t(g,{color:"cyan",size:"small"},{default:s(()=>e[52]||(e[52]=[o("会议已安排")])),_:1,__:[52]})])])]),_:1}),t(j,{title:"结论录入",status:"finish"},{description:s(()=>[l("div",bl,[e[57]||(e[57]=o(" 根据会议结果录入最终立项结论 ")),l("div",kl,[t(g,{color:"green",size:"small"},{default:s(()=>e[54]||(e[54]=[o("立项通过")])),_:1,__:[54]}),t(g,{color:"orange",size:"small"},{default:s(()=>e[55]||(e[55]=[o("有条件通过")])),_:1,__:[55]}),t(g,{color:"red",size:"small"},{default:s(()=>e[56]||(e[56]=[o("立项未通过")])),_:1,__:[56]})])])]),_:1})]),_:1})],512),[[Tt,le.value]])]),l("div",Sl,[l("div",xl,[l("h3",null,[t(c(Dt)),e[58]||(e[58]=o(" 项目审核管理 "))]),l("div",Cl,[t(pe,{value:I.value.status,"onUpdate:value":e[6]||(e[6]=i=>I.value.status=i),placeholder:"筛选状态",style:{width:"150px"},onChange:Be},{default:s(()=>[t(B,{value:""},{default:s(()=>e[59]||(e[59]=[o("全部状态")])),_:1,__:[59]}),t(B,{value:"material_reviewing"},{default:s(()=>e[60]||(e[60]=[o("材料审核中")])),_:1,__:[60]}),t(B,{value:"meeting_preparing"},{default:s(()=>e[61]||(e[61]=[o("会议待组织")])),_:1,__:[61]}),t(B,{value:"meeting_scheduled"},{default:s(()=>e[62]||(e[62]=[o("会议已安排")])),_:1,__:[62]}),t(B,{value:"approval_passed"},{default:s(()=>e[63]||(e[63]=[o("立项通过")])),_:1,__:[63]}),t(B,{value:"approval_conditional"},{default:s(()=>e[64]||(e[64]=[o("有条件通过")])),_:1,__:[64]}),t(B,{value:"approval_failed"},{default:s(()=>e[65]||(e[65]=[o("立项未通过")])),_:1,__:[65]})]),_:1},8,["value"]),t(St,{value:I.value.keyword,"onUpdate:value":e[7]||(e[7]=i=>I.value.keyword=i),placeholder:"搜索项目",style:{width:"200px"},onSearch:De},null,8,["value"])])]),l("div",Rl,[t(xt,{columns:Me,"data-source":Te.value,pagination:we.value,"row-key":"id",size:"middle"},{bodyCell:s(({column:i,record:m})=>[i.key==="currentStatus"?(p(),R(g,{key:0,color:be(m.currentStatus)},{default:s(()=>[o(u(ke(m.currentStatus)),1)]),_:2},1032,["color"])):i.key==="finalResult"?(p(),S(Z,{key:1},[m.finalResult?(p(),R(g,{key:0,color:Oe(m.finalResult)},{default:s(()=>[o(u(qe(m.finalResult)),1)]),_:2},1032,["color"])):(p(),S("span",jl,"待定"))],64)):i.key==="actions"?(p(),R(ce,{key:2},{default:s(()=>[m.currentStatus==="material_reviewing"?(p(),R(d,{key:0,type:"primary",size:"small",onClick:F=>Pe(m)},{default:s(()=>e[66]||(e[66]=[o(" 审核材料 ")])),_:2,__:[66]},1032,["onClick"])):f("",!0),m.currentStatus==="meeting_preparing"?(p(),R(d,{key:1,type:"primary",size:"small",onClick:F=>Ee(m)},{default:s(()=>e[67]||(e[67]=[o(" 组织会议 ")])),_:2,__:[67]},1032,["onClick"])):f("",!0),m.currentStatus==="meeting_scheduled"?(p(),R(d,{key:2,type:"primary",size:"small",onClick:F=>Ve(m)},{default:s(()=>e[68]||(e[68]=[o(" 录入结论 ")])),_:2,__:[68]},1032,["onClick"])):f("",!0),m.currentStatus==="approval_conditional"?(p(),R(d,{key:3,type:"primary",size:"small",onClick:F=>wt(m)},{default:s(()=>e[69]||(e[69]=[o(" 审核整改材料 ")])),_:2,__:[69]},1032,["onClick"])):f("",!0),m.currentStatus==="approval_failed"?(p(),R(d,{key:4,type:"default",size:"small",onClick:F=>yt(m)},{default:s(()=>e[70]||(e[70]=[o(" 重新审核 ")])),_:2,__:[70]},1032,["onClick"])):f("",!0),t(d,{type:"link",size:"small",onClick:F=>Le(m)},{default:s(()=>e[71]||(e[71]=[o(" 查看详情 ")])),_:2,__:[71]},1032,["onClick"])]),_:2},1024)):f("",!0)]),_:1},8,["data-source","pagination"])])]),t(J,{open:E.value,"onUpdate:open":e[10]||(e[10]=i=>E.value=i),title:"材料审核",width:"800px",closable:!1,footer:null},{default:s(()=>[n.value?(p(),S("div",zl,[l("div",hl,[e[72]||(e[72]=l("h4",null,"项目基本信息",-1)),t(D,{column:2,bordered:"",size:"small"},{default:s(()=>[t(_,{label:"项目名称",span:2},{default:s(()=>[o(u(n.value.name),1)]),_:1}),t(_,{label:"项目编号"},{default:s(()=>[o(u(n.value.code),1)]),_:1}),t(_,{label:"申请时间"},{default:s(()=>[o(u(n.value.submitTime),1)]),_:1})]),_:1})]),l("div",Fl,[l("div",Il,[e[75]||(e[75]=l("h4",null,"材料审核",-1)),l("div",Ml,[t(ce,null,{default:s(()=>{var i,m;return[t(d,{type:"primary",size:"small",onClick:ft,disabled:!((i=n.value.materials)!=null&&i.length)},{default:s(()=>e[73]||(e[73]=[o(" 🚀 一键通过全部 ")])),_:1,__:[73]},8,["disabled"]),t(d,{danger:"",size:"small",onClick:_t,disabled:!((m=n.value.materials)!=null&&m.length)},{default:s(()=>e[74]||(e[74]=[o(" 🚫 一键驳回全部 ")])),_:1,__:[74]},8,["disabled"])]}),_:1})])]),l("div",Tl,[(p(!0),S(Z,null,de(n.value.materials,i=>(p(),S("div",{key:i.id,class:"material-item"},[l("div",$l,[l("div",Ol,u(i.name),1),l("div",ql,u(i.type),1)]),l("div",Ul,[t(d,{type:"link",size:"small",onClick:m=>Q(i)},{default:s(()=>[t(c(ee)),e[76]||(e[76]=o(" 预览 "))]),_:2,__:[76]},1032,["onClick"]),t(d,{type:"link",size:"small",onClick:m=>L(i)},{default:s(()=>[t(c(te)),e[77]||(e[77]=o(" 下载 "))]),_:2,__:[77]},1032,["onClick"])]),l("div",Bl,[l("div",Dl,[l("div",{class:re(["status-option",{"status-active":i.reviewStatus==="approved","status-approved":i.reviewStatus==="approved"}]),onClick:m=>ut(i)},[l("div",El,u(i.reviewStatus==="approved"?"✅":"⚪"),1),e[78]||(e[78]=l("div",{class:"status-text"},"通过",-1))],10,Pl),l("div",{class:re(["status-option",{"status-active":i.reviewStatus==="rejected","status-rejected":i.reviewStatus==="rejected"}]),onClick:m=>dt(i)},[l("div",Ll,u(i.reviewStatus==="rejected"?"❌":"⚪"),1),e[79]||(e[79]=l("div",{class:"status-text"},"驳回",-1))],10,Vl),l("div",{class:re(["status-option",{"status-active":!i.reviewStatus||i.reviewStatus==="pending","status-pending":!i.reviewStatus||i.reviewStatus==="pending"}])},[l("div",Hl,u(!i.reviewStatus||i.reviewStatus==="pending"?"⏳":"⚪"),1),e[80]||(e[80]=l("div",{class:"status-text"},"待审",-1))],2)]),i.rejectionReason?(p(),S("div",Al,[t(d,{size:"small",type:"dashed",onClick:m=>rt(i)},{default:s(()=>e[81]||(e[81]=[o(" 📝 编辑意见 ")])),_:2,__:[81]},1032,["onClick"])])):f("",!0)]),i.rejectionReason?(p(),S("div",Jl,[e[82]||(e[82]=l("div",{class:"reason-label"},"驳回意见：",-1)),l("div",Wl,[l("div",{class:re(["reason-text",{"reason-expanded":i.showFullReason}])},u(i.rejectionReason),3),i.rejectionReason.length>50?(p(),R(d,{key:0,type:"link",size:"small",onClick:m=>vt(i),class:"toggle-reason-btn"},{default:s(()=>[o(u(i.showFullReason?"收起":"展开"),1)]),_:2},1032,["onClick"])):f("",!0)])])):f("",!0)]))),128))])]),l("div",Yl,[l("div",Kl,[e[84]||(e[84]=l("h4",null,"审核意见",-1)),t(d,{size:"small",type:"link",onClick:gt,disabled:!$e.value},{default:s(()=>e[83]||(e[83]=[o(" 🔄 重新生成 ")])),_:1,__:[83]},8,["disabled"])]),t(q,{value:h.value.comments,"onUpdate:value":e[8]||(e[8]=i=>h.value.comments=i),placeholder:"审核意见将根据材料审核结果自动生成，您也可以手动编辑补充...",rows:8,"show-count":"",maxlength:1e3,class:"review-comments-textarea"},null,8,["value"]),l("div",Nl,[t(Ce,{message:"提示",description:"审核意见会自动根据各材料的审核结果生成，您可以在此基础上补充整体意见。",type:"info","show-icon":"",closable:!1})])]),l("div",Ql,[e[86]||(e[86]=l("h4",null,"审核结果",-1)),l("div",Gl,[t(g,{color:ie.value==="approved"?"green":"red",size:"large"},{default:s(()=>[o(u(ie.value==="approved"?"材料审核通过":"材料审核不通过"),1)]),_:1},8,["color"]),e[85]||(e[85]=l("span",{class:"result-tip"}," （根据材料审核状态自动确定） ",-1))])]),h.value.result==="rejected"?(p(),S("div",Xl,[t(z,{label:"不通过原因",required:""},{default:s(()=>[t(q,{value:h.value.rejectionReason,"onUpdate:value":e[9]||(e[9]=i=>h.value.rejectionReason=i),placeholder:"请详细说明材料不通过的具体原因，指出需要补充或修改的内容...",rows:4,"show-count":"",maxlength:500},null,8,["value"])]),_:1})])):f("",!0),l("div",Zl,[t(ce,null,{default:s(()=>[t(d,{onClick:Ae},{default:s(()=>e[87]||(e[87]=[o(" 取消 ")])),_:1,__:[87]}),t(d,{type:"primary",onClick:Je},{default:s(()=>e[88]||(e[88]=[o(" 提交审核 ")])),_:1,__:[88]})]),_:1})])])):f("",!0)]),_:1},8,["open"]),t(J,{open:V.value,"onUpdate:open":e[12]||(e[12]=i=>V.value=i),title:"填写驳回意见",width:"500px",onOk:ct,onCancel:mt},{default:s(()=>[M.value?(p(),S("div",es,[l("div",ts,[l("h4",null,u(M.value.name),1),l("p",ls,u(M.value.type),1)]),t(ne,{layout:"vertical"},{default:s(()=>[t(z,{label:"驳回原因",required:""},{default:s(()=>[t(q,{value:O.value.reason,"onUpdate:value":e[11]||(e[11]=i=>O.value.reason=i),placeholder:"请详细说明该材料的问题和改进要求...",rows:4,"show-count":"",maxlength:200},null,8,["value"])]),_:1})]),_:1})])):f("",!0)]),_:1},8,["open"]),t(J,{open:W.value,"onUpdate:open":e[20]||(e[20]=i=>W.value=i),title:"安排验收会议",width:"700px",onOk:We,onCancel:Ye},{default:s(()=>[n.value?(p(),S("div",ss,[t(ne,{model:b.value,layout:"vertical"},{default:s(()=>[t(C,{gutter:24},{default:s(()=>[t(r,{span:12},{default:s(()=>[t(z,{label:"会议时间",required:""},{default:s(()=>[t(Ct,{value:b.value.datetime,"onUpdate:value":e[13]||(e[13]=i=>b.value.datetime=i),"show-time":"",placeholder:"选择会议时间",style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1}),t(r,{span:12},{default:s(()=>[t(z,{label:"会议地点",required:""},{default:s(()=>[t(Rt,{value:b.value.location,"onUpdate:value":e[14]||(e[14]=i=>b.value.location=i),placeholder:"请输入会议地点"},null,8,["value"])]),_:1})]),_:1})]),_:1}),t(z,{label:"会议形式",required:""},{default:s(()=>[t(me,{value:b.value.type,"onUpdate:value":e[15]||(e[15]=i=>b.value.type=i)},{default:s(()=>[t(U,{value:"offline"},{default:s(()=>e[89]||(e[89]=[o("现场会议")])),_:1,__:[89]}),t(U,{value:"online"},{default:s(()=>e[90]||(e[90]=[o("线上会议")])),_:1,__:[90]}),t(U,{value:"hybrid"},{default:s(()=>e[91]||(e[91]=[o("混合会议")])),_:1,__:[91]})]),_:1},8,["value"])]),_:1}),t(z,{label:"会议主持人",required:""},{default:s(()=>[t(pe,{value:b.value.hosts,"onUpdate:value":e[16]||(e[16]=i=>b.value.hosts=i),mode:"tags",placeholder:"选择或输入主持人（可选择多个或手动输入）",style:{width:"100%"},options:Fe.value,"filter-option":Ke},{tagRender:s(({label:i,onClose:m})=>[t(g,{color:"blue",closable:"",onClose:m,style:{"margin-right":"4px","margin-bottom":"4px"}},{default:s(()=>[o(u(i),1)]),_:2},1032,["onClose"])]),_:1},8,["value","options"]),e[92]||(e[92]=l("div",{class:"form-tip"},"可从下拉列表选择或直接输入姓名，支持多个主持人",-1))]),_:1,__:[92]}),t(z,{label:"参会专家",required:""},{default:s(()=>[t(pe,{value:b.value.experts,"onUpdate:value":e[17]||(e[17]=i=>b.value.experts=i),mode:"tags",placeholder:"选择或输入参会专家（可选择多个或手动输入）",style:{width:"100%"},options:Ie.value,"filter-option":Ne},{tagRender:s(({label:i,onClose:m})=>[t(g,{color:"green",closable:"",onClose:m,style:{"margin-right":"4px","margin-bottom":"4px"}},{default:s(()=>[o(u(i),1)]),_:2},1032,["onClose"])]),_:1},8,["value","options"]),e[93]||(e[93]=l("div",{class:"form-tip"},"可从下拉列表选择或直接输入专家姓名，支持多个专家",-1))]),_:1,__:[93]}),t(z,{label:"会议资料"},{default:s(()=>[l("div",as,[t(Re,{"file-list":b.value.materials,"onUpdate:fileList":e[18]||(e[18]=i=>b.value.materials=i),"before-upload":Qe,"on-remove":Ge,multiple:"",accept:".pdf,.doc,.docx,.ppt,.pptx,.xls,.xlsx,.zip,.rar"},{default:s(()=>[t(d,null,{default:s(()=>[t(c(he)),e[94]||(e[94]=o(" 上传会议资料 "))]),_:1,__:[94]})]),_:1},8,["file-list"]),e[96]||(e[96]=l("div",{class:"upload-tip"}," 支持上传PDF、Word、PPT、Excel、压缩包等格式，单个文件不超过50MB ",-1)),b.value.materials&&b.value.materials.length>0?(p(),S("div",is,[(p(!0),S(Z,null,de(b.value.materials,(i,m)=>(p(),S("div",{key:m,class:"material-item"},[t(c($),{class:"file-icon"}),l("span",ns,u(i.name),1),l("span",os,u(Se(i.size)),1),t(d,{type:"link",danger:"",size:"small",onClick:F=>Xe(m)},{default:s(()=>e[95]||(e[95]=[o(" 删除 ")])),_:2,__:[95]},1032,["onClick"])]))),128))])):f("",!0)])]),_:1}),t(z,{label:"会议说明"},{default:s(()=>[t(q,{value:b.value.description,"onUpdate:value":e[19]||(e[19]=i=>b.value.description=i),placeholder:"请填写会议说明...",rows:3,"show-count":"",maxlength:200},null,8,["value"])]),_:1})]),_:1},8,["model"])])):f("",!0)]),_:1},8,["open"]),t(J,{open:Y.value,"onUpdate:open":e[26]||(e[26]=i=>Y.value=i),title:"录入验收结论",width:"800px",onOk:lt,onCancel:st},{default:s(()=>[n.value?(p(),S("div",us,[l("div",ds,[e[97]||(e[97]=l("h4",null,"会议信息",-1)),t(D,{column:2,bordered:"",size:"small"},{default:s(()=>{var i,m;return[t(_,{label:"项目名称",span:2},{default:s(()=>[o(u(n.value.name),1)]),_:1}),t(_,{label:"会议时间"},{default:s(()=>{var F;return[o(u(((F=n.value.meetingInfo)==null?void 0:F.time)||"会议时间待确定"),1)]}),_:1}),t(_,{label:"会议地点"},{default:s(()=>{var F;return[o(u(((F=n.value.meetingInfo)==null?void 0:F.location)||"会议地点待确定"),1)]}),_:1}),(i=n.value.meetingInfo)!=null&&i.type?(p(),R(_,{key:0,label:"会议形式"},{default:s(()=>[o(u(n.value.meetingInfo.type==="offline"?"现场会议":n.value.meetingInfo.type==="online"?"线上会议":"混合会议"),1)]),_:1})):f("",!0),(m=n.value.meetingInfo)!=null&&m.description?(p(),R(_,{key:1,label:"会议说明",span:2},{default:s(()=>[o(u(n.value.meetingInfo.description),1)]),_:1})):f("",!0)]}),_:1})]),t(ne,{model:w.value,layout:"vertical"},{default:s(()=>[t(z,{label:"验收结论",required:""},{default:s(()=>[t(me,{value:w.value.conclusion,"onUpdate:value":e[21]||(e[21]=i=>w.value.conclusion=i)},{default:s(()=>[t(U,{value:"passed"},{default:s(()=>e[98]||(e[98]=[o("验收通过")])),_:1,__:[98]}),t(U,{value:"conditional_passed"},{default:s(()=>e[99]||(e[99]=[o("有条件通过")])),_:1,__:[99]}),t(U,{value:"failed"},{default:s(()=>e[100]||(e[100]=[o("验收不通过")])),_:1,__:[100]})]),_:1},8,["value"])]),_:1}),t(z,{label:"验收评分"},{default:s(()=>[t(jt,{value:w.value.score,"onUpdate:value":e[22]||(e[22]=i=>w.value.score=i),min:0,max:100,placeholder:"请输入评分",style:{width:"200px"}},null,8,["value"]),e[101]||(e[101]=l("span",{style:{"margin-left":"8px"}},"分",-1))]),_:1,__:[101]}),t(z,{label:"结论说明",required:""},{default:s(()=>[t(q,{value:w.value.description,"onUpdate:value":e[23]||(e[23]=i=>w.value.description=i),placeholder:"请详细说明验收结论...",rows:4,"show-count":"",maxlength:500},null,8,["value"])]),_:1}),w.value.conclusion!=="passed"?(p(),R(z,{key:0,label:"整改要求"},{default:s(()=>[t(q,{value:w.value.requirements,"onUpdate:value":e[24]||(e[24]=i=>w.value.requirements=i),placeholder:"请填写整改要求...",rows:3,"show-count":"",maxlength:300},null,8,["value"])]),_:1})):f("",!0),t(z,{label:"结论相关文件"},{default:s(()=>[l("div",rs,[t(Re,{"file-list":w.value.conclusionFiles,"onUpdate:fileList":e[25]||(e[25]=i=>w.value.conclusionFiles=i),"before-upload":Ze,"on-remove":et,multiple:"",accept:".pdf,.doc,.docx,.xls,.xlsx"},{default:s(()=>[t(d,null,{default:s(()=>[t(c(he)),e[102]||(e[102]=o(" 上传结论文件 "))]),_:1,__:[102]})]),_:1},8,["file-list"]),w.value.conclusionFiles.length>0?(p(),S("div",vs,[(p(!0),S(Z,null,de(w.value.conclusionFiles,(i,m)=>(p(),S("div",{key:m,class:"file-item"},[t(c($),{class:"file-icon"}),l("span",ps,u(i.name),1),l("span",cs,u(Se(i.size)),1),t(d,{type:"link",danger:"",size:"small",onClick:F=>tt(m)},{default:s(()=>e[103]||(e[103]=[o(" 删除 ")])),_:2,__:[103]},1032,["onClick"])]))),128))])):f("",!0),e[104]||(e[104]=l("div",{class:"upload-tip"},[l("small",{style:{color:"#999"}}," 支持上传 PDF、Word、Excel 文件，单个文件大小不超过 20MB ")],-1))])]),_:1})]),_:1},8,["model"])])):f("",!0)]),_:1},8,["open"]),t(J,{open:K.value,"onUpdate:open":e[36]||(e[36]=i=>K.value=i),title:"审核整改材料",width:"900px",onOk:at,onCancel:it},{default:s(()=>[n.value?(p(),S("div",ms,[l("div",fs,[e[105]||(e[105]=l("h4",null,"项目基本信息",-1)),t(D,{column:2,bordered:"",size:"small"},{default:s(()=>[t(_,{label:"项目名称",span:2},{default:s(()=>[o(u(n.value.name),1)]),_:1}),t(_,{label:"项目编号"},{default:s(()=>[o(u(n.value.code),1)]),_:1}),t(_,{label:"提交时间"},{default:s(()=>[o(u(n.value.submitTime),1)]),_:1})]),_:1})]),n.value.conclusion&&n.value.conclusion.requirements?(p(),S("div",_s,[e[106]||(e[106]=l("h4",null,"原始整改要求",-1)),l("div",gs,[t(Ce,{type:"warning","show-icon":"",message:n.value.conclusion.requirements},null,8,["message"])])])):f("",!0),l("div",ws,[e[122]||(e[122]=l("h4",null,"申请人提交的整改材料",-1)),l("div",ys,[l("div",bs,[l("div",ks,[l("div",Ss,[t(c($)),e[107]||(e[107]=o(" 数据备份机制说明.pdf "))]),l("div",xs,[e[108]||(e[108]=l("span",{class:"material-type"},"整改材料",-1)),e[109]||(e[109]=l("span",{class:"material-size"},"2.3MB",-1)),l("span",Cs,u(n.value.improvementSubmitTime||"2024-01-28 14:30"),1)])]),l("div",Rs,[t(d,{type:"link",size:"small",onClick:e[27]||(e[27]=i=>Q({name:"数据备份机制说明.pdf"}))},{default:s(()=>[t(c(ee)),e[110]||(e[110]=o(" 预览 "))]),_:1,__:[110]}),t(d,{type:"link",size:"small",onClick:e[28]||(e[28]=i=>L({name:"数据备份机制说明.pdf"}))},{default:s(()=>[t(c(te)),e[111]||(e[111]=o(" 下载 "))]),_:1,__:[111]})])]),l("div",js,[l("div",zs,[l("div",hs,[t(c($)),e[112]||(e[112]=o(" 系统界面优化报告.pdf "))]),l("div",Fs,[e[113]||(e[113]=l("span",{class:"material-type"},"整改材料",-1)),e[114]||(e[114]=l("span",{class:"material-size"},"1.8MB",-1)),l("span",Is,u(n.value.improvementSubmitTime||"2024-01-28 14:30"),1)])]),l("div",Ms,[t(d,{type:"link",size:"small",onClick:e[29]||(e[29]=i=>Q({name:"系统界面优化报告.pdf"}))},{default:s(()=>[t(c(ee)),e[115]||(e[115]=o(" 预览 "))]),_:1,__:[115]}),t(d,{type:"link",size:"small",onClick:e[30]||(e[30]=i=>L({name:"系统界面优化报告.pdf"}))},{default:s(()=>[t(c(te)),e[116]||(e[116]=o(" 下载 "))]),_:1,__:[116]})])]),l("div",Ts,[l("div",$s,[l("div",Os,[t(c($)),e[117]||(e[117]=o(" 系统操作说明文档.docx "))]),l("div",qs,[e[118]||(e[118]=l("span",{class:"material-type"},"整改材料",-1)),e[119]||(e[119]=l("span",{class:"material-size"},"1.2MB",-1)),l("span",Us,u(n.value.improvementSubmitTime||"2024-01-28 14:30"),1)])]),l("div",Bs,[t(d,{type:"link",size:"small",onClick:e[31]||(e[31]=i=>Q({name:"系统操作说明文档.docx"}))},{default:s(()=>[t(c(ee)),e[120]||(e[120]=o(" 预览 "))]),_:1,__:[120]}),t(d,{type:"link",size:"small",onClick:e[32]||(e[32]=i=>L({name:"系统操作说明文档.docx"}))},{default:s(()=>[t(c(te)),e[121]||(e[121]=o(" 下载 "))]),_:1,__:[121]})])])])]),l("div",Ds,[e[126]||(e[126]=l("h4",null,"申请人整改说明",-1)),l("div",Ps,[t(zt,{size:"small",class:"improvement-description-card"},{default:s(()=>[l("div",Es,[e[125]||(e[125]=l("p",null,[l("strong",null,"整改完成情况：")],-1)),l("div",Vs,[l("p",null,u(n.value.improvementDescription||"1. 已完善数据备份机制，建立了自动备份和手动备份双重保障体系；"),1),e[123]||(e[123]=l("p",null,u("2. 优化了系统界面布局，提升用户交互体验；"),-1)),e[124]||(e[124]=l("p",null,u("3. 编写了详细的操作说明文档，便于用户使用。"),-1))]),l("div",Ls,[t(c(_e)),l("span",null,"提交时间："+u(n.value.improvementSubmitTime||"2024-01-28 14:30"),1)])])]),_:1})])]),l("div",Hs,[e[129]||(e[129]=l("h4",null,"审核结果",-1)),t(ne,{layout:"vertical"},{default:s(()=>[t(z,{label:"审核结论",required:""},{default:s(()=>[t(me,{value:T.value.result,"onUpdate:value":e[33]||(e[33]=i=>T.value.result=i),class:"review-result-group"},{default:s(()=>[t(U,{value:"approved",class:"review-option"},{default:s(()=>[t(c(ue),{style:{color:"#52c41a","margin-right":"8px"}}),e[127]||(e[127]=o(" 整改完成，立项通过 "))]),_:1,__:[127]}),t(U,{value:"rejected",class:"review-option"},{default:s(()=>[t(c(Ut),{style:{color:"#faad14","margin-right":"8px"}}),e[128]||(e[128]=o(" 整改不满足要求，需要继续整改 "))]),_:1,__:[128]})]),_:1},8,["value"])]),_:1}),t(z,{label:"审核意见",required:""},{default:s(()=>[t(q,{value:T.value.comments,"onUpdate:value":e[34]||(e[34]=i=>T.value.comments=i),placeholder:"请填写详细的审核意见...",rows:4,"show-count":"",maxlength:500},null,8,["value"])]),_:1}),T.value.result==="rejected"?(p(),R(z,{key:0,label:"新的整改要求",required:""},{default:s(()=>[t(q,{value:T.value.requirements,"onUpdate:value":e[35]||(e[35]=i=>T.value.requirements=i),placeholder:"请明确指出需要继续整改的具体内容和要求...",rows:3,"show-count":"",maxlength:300},null,8,["value"])]),_:1})):f("",!0)]),_:1})])])):f("",!0)]),_:1},8,["open"]),t(J,{open:se.value,"onUpdate:open":e[37]||(e[37]=i=>se.value=i),title:"项目详情",width:"1000px",footer:null,onCancel:He},{default:s(()=>[n.value?(p(),S("div",As,[l("div",Js,[l("h4",null,[t(c(Vt)),e[130]||(e[130]=o(" 项目基本信息"))]),t(D,{column:2,bordered:"",size:"small"},{default:s(()=>[t(_,{label:"年度"},{default:s(()=>[o(u(n.value.year),1)]),_:1}),t(_,{label:"项目编号"},{default:s(()=>[o(u(n.value.code),1)]),_:1}),t(_,{label:"立项名称",span:2},{default:s(()=>[o(u(n.value.name),1)]),_:1}),t(_,{label:"申请人"},{default:s(()=>[o(u(n.value.applicant),1)]),_:1}),t(_,{label:"申请单位"},{default:s(()=>[o(u(n.value.department),1)]),_:1}),t(_,{label:"项目周期(月)"},{default:s(()=>[o(u(n.value.duration)+"个月 ",1)]),_:1}),t(_,{label:"预算(万元)"},{default:s(()=>[o(u(n.value.budget)+"万元 ",1)]),_:1}),t(_,{label:"申请时间"},{default:s(()=>[o(u(n.value.submitTime),1)]),_:1}),t(_,{label:"当前状态"},{default:s(()=>[t(g,{color:be(n.value.currentStatus)},{default:s(()=>[o(u(ke(n.value.currentStatus)),1)]),_:1},8,["color"])]),_:1}),n.value.finalResult?(p(),R(_,{key:0,label:"最终结果"},{default:s(()=>[t(g,{color:n.value.finalResult==="passed"?"green":n.value.finalResult==="failed"?"red":"orange"},{default:s(()=>[o(u(n.value.finalResult==="passed"?"立项通过":n.value.finalResult==="failed"?"立项未通过":"有条件通过"),1)]),_:1},8,["color"])]),_:1})):f("",!0)]),_:1})]),l("div",Ws,[l("h4",null,[t(c($)),e[131]||(e[131]=o(" 验收材料"))]),l("div",Ys,[(p(!0),S(Z,null,de(n.value.materials,i=>(p(),S("div",{key:i.id,class:"material-item"},[l("div",Ks,[l("div",Ns,[t(c($)),o(" "+u(i.name),1)]),l("div",Qs,[l("span",Gs,u(i.type),1),t(g,{color:i.reviewStatus==="approved"?"green":i.reviewStatus==="rejected"?"red":"orange",size:"small"},{default:s(()=>[o(u(i.reviewStatus==="approved"?"已通过":i.reviewStatus==="rejected"?"已驳回":"待审核"),1)]),_:2},1032,["color"])])]),l("div",Xs,[t(d,{type:"link",size:"small",onClick:m=>Q(i)},{default:s(()=>[t(c(ee)),e[132]||(e[132]=o(" 预览 "))]),_:2,__:[132]},1032,["onClick"]),t(d,{type:"link",size:"small",onClick:m=>L(i)},{default:s(()=>[t(c(te)),e[133]||(e[133]=o(" 下载 "))]),_:2,__:[133]},1032,["onClick"])])]))),128))])]),n.value.meetingInfo?(p(),S("div",Zs,[l("h4",null,[t(c(fe)),e[134]||(e[134]=o(" 会议信息"))]),t(D,{column:2,bordered:"",size:"small"},{default:s(()=>[t(_,{label:"会议时间"},{default:s(()=>[o(u(n.value.meetingInfo.time),1)]),_:1}),t(_,{label:"会议地点"},{default:s(()=>[o(u(n.value.meetingInfo.location),1)]),_:1}),t(_,{label:"会议形式",span:2},{default:s(()=>[o(u(n.value.meetingInfo.type==="offline"?"现场会议":n.value.meetingInfo.type==="online"?"线上会议":"混合会议"),1)]),_:1}),n.value.meetingInfo.description?(p(),R(_,{key:0,label:"会议说明",span:2},{default:s(()=>[o(u(n.value.meetingInfo.description),1)]),_:1})):f("",!0)]),_:1})])):f("",!0),n.value.conclusion?(p(),S("div",ea,[l("h4",null,[t(c(ge)),e[135]||(e[135]=o(" 验收结论"))]),t(D,{column:2,bordered:"",size:"small"},{default:s(()=>[t(_,{label:"验收结果"},{default:s(()=>[t(g,{color:n.value.conclusion.result==="passed"?"green":n.value.conclusion.result==="failed"?"red":"orange"},{default:s(()=>[o(u(n.value.conclusion.result==="passed"?"验收通过":n.value.conclusion.result==="failed"?"验收不通过":"有条件通过"),1)]),_:1},8,["color"])]),_:1}),t(_,{label:"验收时间"},{default:s(()=>[o(u(n.value.conclusion.time),1)]),_:1}),n.value.conclusion.score?(p(),R(_,{key:0,label:"验收评分"},{default:s(()=>[l("span",{style:Bt({color:n.value.conclusion.score>=90?"#52c41a":n.value.conclusion.score>=80?"#fa8c16":"#ff4d4f"})},u(n.value.conclusion.score)+"分 ",5)]),_:1})):f("",!0),t(_,{label:"验收说明",span:2},{default:s(()=>[o(u(n.value.conclusion.description),1)]),_:1}),n.value.conclusion.requirements?(p(),R(_,{key:1,label:"整改要求",span:2},{default:s(()=>[l("div",ta,u(n.value.conclusion.requirements),1)]),_:1})):f("",!0)]),_:1})])):f("",!0),n.value.improvementSubmitted?(p(),S("div",la,[l("h4",null,[t(c(ue)),e[136]||(e[136]=o(" 整改情况"))]),t(D,{column:2,bordered:"",size:"small"},{default:s(()=>[t(_,{label:"提交状态"},{default:s(()=>[t(g,{color:"blue"},{default:s(()=>e[137]||(e[137]=[o("已提交整改材料")])),_:1,__:[137]})]),_:1}),t(_,{label:"提交时间"},{default:s(()=>[o(u(n.value.improvementSubmitTime),1)]),_:1}),t(_,{label:"整改说明",span:2},{default:s(()=>[l("div",sa,u(n.value.improvementDescription),1)]),_:1})]),_:1})])):f("",!0),l("div",aa,[l("h4",null,[t(c(_e)),e[138]||(e[138]=o(" 审核历史"))]),t(ht,null,{default:s(()=>[t(X,{color:"blue"},{dot:s(()=>[t(c($))]),default:s(()=>[l("div",ia,[e[139]||(e[139]=l("div",{class:"timeline-title"},"项目验收申请提交",-1)),l("div",na,u(n.value.submitTime),1)])]),_:1}),n.value.materialStatus==="approved"?(p(),R(X,{key:0,color:"green"},{dot:s(()=>[t(c(ue))]),default:s(()=>[l("div",oa,[e[140]||(e[140]=l("div",{class:"timeline-title"},"材料审核通过",-1)),l("div",ua,u(n.value.materialReviewTime||"2024-01-18"),1)])]),_:1})):f("",!0),n.value.meetingScheduled?(p(),R(X,{key:1,color:"blue"},{dot:s(()=>[t(c(fe))]),default:s(()=>{var i;return[l("div",da,[e[141]||(e[141]=l("div",{class:"timeline-title"},"验收会议安排",-1)),l("div",ra,u((i=n.value.meetingInfo)==null?void 0:i.time),1)])]}),_:1})):f("",!0),n.value.conclusion?(p(),R(X,{key:2,color:n.value.conclusion.result==="passed"?"green":n.value.conclusion.result==="failed"?"red":"orange"},{dot:s(()=>[t(c(ge))]),default:s(()=>[l("div",va,[l("div",pa,u(n.value.conclusion.result==="passed"?"验收通过":n.value.conclusion.result==="failed"?"验收不通过":"有条件通过"),1),l("div",ca,u(n.value.conclusion.time),1)])]),_:1},8,["color"])):f("",!0),n.value.improvementSubmitted?(p(),R(X,{key:3,color:"blue"},{dot:s(()=>[t(c($))]),default:s(()=>[l("div",ma,[e[142]||(e[142]=l("div",{class:"timeline-title"},"整改材料提交",-1)),l("div",fa,u(n.value.improvementSubmitTime),1)])]),_:1})):f("",!0)]),_:1})])])):f("",!0)]),_:1},8,["open"]),t(Pt,{visible:ve.value,"onUpdate:visible":e[38]||(e[38]=i=>ve.value=i),"file-info":ye.value,onDownload:nt},null,8,["visible","file-info"])])}}},za=Ft(_a,[["__scopeId","data-v-5f749d3e"]]);export{za as default};
