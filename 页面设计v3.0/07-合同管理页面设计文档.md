# 📋 合同管理页面设计文档 v2.0

## 📄 页面基础信息

- **页面名称**: 合同管理（Contract Management）
- **路由地址**: `/implementation/contract`
- **组件路径**: `src/views/implementation/contract/index.vue`
- **设计版本**: v2.0
- **更新时间**: 2025-01-17
- **实现状态**: 📋 设计阶段

## 🔄 v2.0版本设计说明

### 🎯 核心功能定位
合同管理页面是项目实施阶段的重要组成部分，负责合同文件的全生命周期管理，包括合同起草、审核、签署、执行、变更等核心业务。

### 📊 业务流程设计
```
合同起草 → 内部审核 → 法务审核 → 客户协商 → 正式签署 → 执行监控
    ↓        ↓        ↓        ↓        ↓        ↓
  模板选择  条款检查  合规审查  修改确认  电子签名  履约跟踪
```

## 🎨 UI布局草图

### 页面整体布局

```
┌─────────────────────────────────────────────────────────────────┐
│                     📋 合同管理                                  │
│                 (背景 #f5f8ff, 全屏布局)                        │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │              📊 合同统计概览卡片                         │   │
│  │  ┌──────┐  ┌──────┐  ┌──────┐  ┌──────┐  ┌──────┐      │   │
│  │  │草稿中│  │审核中│  │已签署│  │已完成│  │总金额│      │   │
│  │  │ 8    │  │ 15   │  │ 45   │  │ 156  │  │1.5亿 │      │   │
│  │  │ 📝   │  │ 🔍   │  │ ✍️   │  │ ✅   │  │ 💰   │      │   │
│  │  └──────┘  └──────┘  └──────┘  └──────┘  └──────┘      │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │           🔍 筛选和操作工具栏                             │   │
│  │  状态[全部▼] 类型[全部▼] 签署方[全部▼] 时间[全部▼]        │   │
│  │                              [📄新建合同] [📁批量导入]   │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                📋 合同列表                               │   │
│  │ ┌─────────────────────────────────────────────────────┐ │   │
│  │ │ 📄 智慧水务系统开发合同      【已签署】  2025-01-15  │ │   │
│  │ │ 甲方：华中科技大学  乙方：XX科技公司   金额：50万    │ │   │
│  │ │ 周期：6个月  进度：65%  状态：执行中    [查看][编辑] │ │   │
│  │ └─────────────────────────────────────────────────────┘ │   │
│  │ ┌─────────────────────────────────────────────────────┐ │   │
│  │ │ 🔍 污水处理平台开发合同      【审核中】  2025-01-10  │ │   │
│  │ │ 甲方：华中科技大学  乙方：YY公司       金额：80万    │ │   │
│  │ │ 周期：8个月  审核：法务部   状态：待确认 [查看][催办] │ │   │
│  │ └─────────────────────────────────────────────────────┘ │   │
│  │ ┌─────────────────────────────────────────────────────┐ │   │
│  │ │ ✅ 水质监测设备采购合同      【已完成】  2024-12-01  │ │   │
│  │ │ 甲方：华中科技大学  乙方：ZZ设备公司   金额：120万   │ │   │
│  │ │ 周期：3个月  完成：100%     状态：已归档 [查看][存档] │ │   │
│  │ └─────────────────────────────────────────────────────┘ │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │              📄 分页和批量操作                           │   │
│  │  ☐全选 批量操作[下拉] [导出PDF]       [1][2][3]...[9]  │   │
│  └─────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
```

### 合同详情页面设计

```
┌─────────────────────────────────────────────────────────────────┐
│              📋 合同详情 - 智慧水务系统开发合同                    │
├─────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐  ┌─────────────────────────────────────┐   │
│  │   📊 基本信息    │  │          📄 合同文档                │   │
│  │                 │  │                                     │   │
│  │ 合同编号: CT2025 │  │  [📄 合同正文.pdf]    [预览] [下载] │   │
│  │ 签署日期: 2025-01│  │  [📄 技术附件.docx]   [预览] [下载] │   │
│  │ 甲方: 华中科技大学│  │  [📊 预算明细.xlsx]   [预览] [下载] │   │
│  │ 乙方: XX科技公司 │  │                                     │   │
│  │ 合同金额: 50万   │  │  🤖 AI解析结果:                     │   │
│  │ 履约期限: 6个月  │  │  - 关键条款: 5条                    │   │
│  │ 当前状态: 执行中 │  │  - 风险提示: 1处                    │   │
│  │                 │  │  - 付款节点: 3个                    │   │
│  └─────────────────┘  └─────────────────────────────────────┘   │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                 📈 执行进度                             │   │
│  │  ████████████████████████████████████░░░░░░░░░ 65%      │   │
│  │                                                         │   │
│  │  里程碑进度:                                            │   │
│  │  ✅ 需求确认  ✅ 设计完成  🔄 开发阶段  ⏸️ 测试阶段    │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                 📅 审批记录                             │   │
│  │  2025-01-10 | 合同起草   | 张工程师 | 完成              │   │
│  │  2025-01-12 | 内部审核   | 李主管   | 通过              │   │
│  │  2025-01-14 | 法务审核   | 王律师   | 通过              │   │
│  │  2025-01-15 | 客户签署   | 客户方   | 已签署            │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│                    [编辑] [变更] [终止] [归档]                 │
└─────────────────────────────────────────────────────────────────┘
```

### 合同模板管理界面

```
┌─────────────────────────────────────────────────────────────────┐
│                     📄 合同模板管理                               │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                📋 标准模板库                             │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐      │   │
│  │  │ 🔬 研发合同  │  │ 📦 采购合同  │  │ 🤝 服务合同  │      │   │
│  │  │   模板      │  │   模板      │  │   模板      │      │   │
│  │  │ [使用][编辑] │  │ [使用][编辑] │  │ [使用][编辑] │      │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘      │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                🎨 自定义模板                             │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐      │   │
│  │  │ 📄 模板A    │  │ 📄 模板B    │  │ ➕ 新建模板  │      │   │
│  │  │ 水务专用    │  │ 设备采购    │  │             │      │   │
│  │  │ [使用][编辑] │  │ [使用][编辑] │  │    [创建]    │      │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘      │   │
│  └─────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
```

## 📐 设计规格

### 🌈 色彩方案
- **页面背景**: `#f5f8ff` (淡蓝色)
- **卡片背景**: `#ffffff` (纯白)
- **统计卡片渐变**: `linear-gradient(135deg, #667eea 0%, #764ba2 100%)`
- **状态标签颜色**:
  - 草稿中: `#d9d9d9` (灰色)
  - 审核中: `#1890ff` (蓝色)
  - 已签署: `#52c41a` (绿色)
  - 已完成: `#722ed1` (紫色)
  - 已终止: `#ff4d4f` (红色)

### 📏 尺寸规格
- **页面内边距**: `24px`
- **卡片圆角**: `12px`
- **卡片间距**: `16px`
- **统计卡片高度**: `120px`
- **列表项高度**: `最小120px`

### 📝 字体规格
- **页面标题**: 24px, font-weight: bold
- **统计数字**: 28px, font-weight: bold
- **合同名称**: 16px, font-weight: 600
- **详细信息**: 13px
- **状态标签**: 12px, font-weight: 500

## ⚡ 交互逻辑

### 🔄 页面初始化逻辑

1. **数据加载**
   ```javascript
   /**
    * 页面挂载时加载合同统计数据
    */
   async function loadContractStats() {
     const stats = await fetchContractStatistics();
     contractStats.value = stats;
   }
   
   /**
    * 加载合同列表
    */
   async function loadContractList() {
     const list = await fetchContractList(currentPage.value, pageSize.value, filters.value);
     contractList.value = list.data;
     total.value = list.total;
   }
   ```

2. **OA系统集成**
   ```javascript
   /**
    * 同步OA系统合同数据
    */
   async function syncOAContracts() {
     try {
       await syncContractsFromOA();
       message.success('OA系统合同数据同步成功');
       loadContractList();
     } catch (error) {
       message.error('同步失败：' + error.message);
     }
   }
   ```

### 🎯 核心交互功能

1. **合同创建流程**
   ```javascript
   /**
    * 新建合同
    */
   function createNewContract() {
     showContractModal.value = true;
     contractForm.value = getDefaultContractForm();
   }
   
   /**
    * 使用模板创建合同
    */
   function createFromTemplate(templateId) {
     const template = templates.value.find(t => t.id === templateId);
     contractForm.value = { ...template.content };
     showContractModal.value = true;
   }
   ```

2. **AI合同解析**
   ```javascript
   /**
    * AI解析合同文档
    */
   async function parseContractWithAI(fileId) {
     const result = await aiParseContract(fileId);
     aiAnalysis.value = {
       keyTerms: result.keyTerms,
       riskPoints: result.riskPoints,
       paymentNodes: result.paymentNodes
     };
   }
   ```

### 🔍 文档管理逻辑

1. **文件上传处理**
   ```javascript
   /**
    * 合同文档上传
    */
   function handleFileUpload(file) {
     const formData = new FormData();
     formData.append('file', file);
     formData.append('contractId', currentContract.value.id);
     return uploadContractFile(formData);
   }
   ```

2. **版本控制**
   ```javascript
   /**
    * 合同版本管理
    */
   function createContractVersion() {
     const version = {
       contractId: currentContract.value.id,
       version: getNextVersion(),
       content: contractForm.value,
       createTime: new Date()
     };
     saveContractVersion(version);
   }
   ```

## 🌐 页面间跳转

### 📍 主要跳转路径

1. **内部跳转**
   - 合同详情: `/implementation/contract` → `/implementation/contract/detail/:id`
   - 合同编辑: `/implementation/contract` → `/implementation/contract/edit/:id`
   - 模板管理: `/implementation/contract` → `/implementation/contract/templates`

2. **外部跳转**
   - 项目管理: `/implementation/contract` → `/implementation/center`
   - 付款管理: `/implementation/contract` → `/implementation/payment`
   - OA系统: 外部链接到OA合同系统

## 🛠️ 技术实现

### 🔧 核心技术栈
- **UI组件**: Ant Design Vue (Table, Upload, Modal, Steps)
- **文档预览**: PDF.js、Office Online
- **状态管理**: Pinia (合同数据状态)
- **文件处理**: 文件上传、版本控制
- **AI集成**: 合同解析API

### 📦 关键组件设计

1. **ContractCard 合同卡片组件**
   ```vue
   <template>
     <div class="contract-card">
       <div class="contract-header">
         <h3>{{ contract.name }}</h3>
         <StatusTag :status="contract.status" />
       </div>
       <div class="contract-info">
         <ContractInfo :contract="contract" />
       </div>
       <div class="contract-actions">
         <ActionButtons :contract="contract" @action="handleAction" />
       </div>
     </div>
   </template>
   ```

2. **DocumentViewer 文档预览组件**
   ```vue
   <template>
     <div class="document-viewer">
       <div class="viewer-toolbar">
         <ToolbarButtons @action="handleViewerAction" />
       </div>
       <div class="viewer-content">
         <PDFViewer v-if="isPDF" :file="currentFile" />
         <OfficeViewer v-else :file="currentFile" />
       </div>
     </div>
   </template>
   ```

### 🗄️ 数据模型设计

```typescript
interface Contract {
  id: string;
  name: string;
  number: string;
  type: string;
  partyA: string;
  partyB: string;
  amount: number;
  duration: number;
  startDate: string;
  endDate: string;
  status: 'draft' | 'reviewing' | 'signed' | 'executing' | 'completed' | 'terminated';
  progress: number;
  documents: ContractDocument[];
  milestones: Milestone[];
  reviews: ReviewRecord[];
  aiAnalysis?: AIAnalysisResult;
  createdAt: string;
  updatedAt: string;
}

interface ContractDocument {
  id: string;
  name: string;
  type: string;
  size: number;
  url: string;
  version: string;
  uploadTime: string;
}

interface AIAnalysisResult {
  keyTerms: string[];
  riskPoints: string[];
  paymentNodes: PaymentNode[];
  complianceCheck: boolean;
}
```

## 🌟 用户体验亮点

### ✨ 设计特色

1. **智能化合同处理**
   - AI自动解析合同条款
   - 智能风险识别提醒
   - 自动提取关键信息

2. **可视化执行监控**
   - 进度条显示执行状态
   - 里程碑节点可视化
   - 实时状态更新提醒

3. **规范化模板管理**
   - 标准合同模板库
   - 自定义模板支持
   - 模板版本控制

### 🚀 功能亮点

1. **全生命周期管理**
   - 从起草到归档的完整流程
   - 多角色协同审批
   - 实时状态跟踪

2. **智能化辅助功能**
   - AI合同条款解析
   - 风险点自动识别
   - 合规性检查提醒

3. **系统集成能力**
   - OA系统无缝对接
   - 电子签名集成
   - 文档版本管理

## 📋 待优化项

### 🔄 短期优化 (v2.1)
- [ ] 增加电子签名功能
- [ ] 实现合同模板智能推荐
- [ ] 优化文档预览体验
- [ ] 增加合同执行预警

### 🎯 中期优化 (v2.2)
- [ ] 集成区块链合同存证
- [ ] 实现智能合同分析
- [ ] 增加法务专家系统
- [ ] 支持多语言合同管理

### 🌟 长期规划 (v3.0)
- [ ] AI自动生成合同
- [ ] 智能法律风险评估
- [ ] 区块链数字合同
- [ ] 国际化合同管理

---

**📝 设计说明**: 合同管理页面通过数字化手段实现合同全生命周期管理，结合AI技术提升合同处理效率，为科研项目的合规执行提供有力保障。 